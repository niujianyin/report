/*!
* new_comment
* v 2.0.0
* svn ../ui/project/new_comment/trunk/
* 2015-04-03 06:36
* [28,470,248] published at 2015-04-03 18:30:01
*/
!function(exports,undefined){var C={U:"undefined"},doc=document,byId=function(a){return"string"==typeof a?doc.getElementById(a):a},byTag=function(a){return"string"==typeof a?doc.getElementsByTagName(a):a},byAttr=function(a,b,c){"string"==typeof a&&(a=byId(a));var d=[];c=c||"";for(var e=function(a){return a.getAttribute(b)},f=0,g=a.childNodes.length;g>f;f++)if(1==a.childNodes[f].nodeType){var h=!1;h=c?e(a.childNodes[f])==c:!!e(a.childNodes[f]),h&&d.push(a.childNodes[f]),a.childNodes[f].childNodes.length>0&&(d=d.concat(arguments.callee.call(null,a.childNodes[f],b,c)))}return d},hasClass=function(a,b){return a?a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)")):!1},addClass=function(a,b){hasClass(a,b)||(a.className=a.className.replace(/(^\s*)|(\s*$)/g,"")+" "+b)},removeClass=function(a,b){if(hasClass(a,b)){var c=new RegExp("(\\s|^)"+b+"(\\s|$)");a.className=a.className.replace(c," ")}},toggleClass=function(a,b){hasClass(a,b)?removeClass(a,b):addClass(a,b)},preventDefault=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1},stopPropagation=function(a){a=a||window.event,window.event?a.cancelBubble=!0:a.stopPropagation()},contains=function(a,b){try{return a.contains?a!=b&&a.contains(b):!!(16&a.compareDocumentPosition(b))}catch(c){}},create=function(a){return a=a.toUpperCase(),"TEXT"==a?doc.createTextNode(""):"BUFFER"==a?doc.createDocumentFragment():doc.createElement(a)},insertAfter=function(a,b){var c=b.parentNode;c.lastChild==b?c.appendChild(a):c.insertBefore(a,b.nextSibling)},ua=function(){var a=navigator.userAgent.toLowerCase(),b={};return b.isIE=/msie/.test(a),b.isOPERA=/opera/.test(a),b.isMOZ=/gecko/.test(a),b.isIE6=/msie 6/.test(a),b.isIE7=/msie 7/.test(a),b.isSAFARI=/safari/.test(a),b.iswinXP=/windows nt 5.1/.test(a),b.iswinVista=/windows nt 6.0/.test(a),b.isFF=/firefox/.test(a),b.isIOS=/\((iPhone|iPad|iPod)/i.test(a),b}(),domReady=function(){var a=[],b=0,c=0,d=function(){return"complete"===doc.readyState?1:c},e=function(){if(!c){if(c=1,a)for(;a.length;)a.shift()();a=null}},f=function(){b||(b=1,"complete"===doc.readyState?e():doc.addEventListener?(doc.addEventListener("DOMContentLoaded",function(){doc.removeEventListener("DOMContentLoaded",arguments.callee,!1),e()},!1),window.addEventListener("load",function(){window.removeEventListener("load",arguments.callee,!1),e()},!1)):(doc.attachEvent("onreadystatechange",function(){"complete"==doc.readyState&&(doc.detachEvent("onreadystatechange",arguments.callee),e())}),function(){if(!c){var a=new Image;try{a.doScroll(),a=null}catch(b){return void setTimeout(arguments.callee,64)}e()}}()))};return function(b){return f(),d()?void b.call():void a.push(b)}}(),timeoutHandle=function(){var a=[],b={success:function(b){var c=a[b];c&&(c.isSuccess=!0,clearTimeout(c.timer))},timeout:function(b,c){var d=a[b];d&&(d.timer=setTimeout(function(){d.isSuccess||"function"==typeof c&&c.call(this)},d.time))}};return function(c,d,e){if(a[c])throw new Error(c+"\u5DF2\u7ECF\u88AB\u5360\u7528");a[c]={},a[c].time=e||5e3,a[c].isSuccess=!1,"function"==typeof d&&d.call(this,b)}}(),getXY=function(){var a=function(a){if((null==a.parentNode||null==a.offsetParent||"none"==getStyle(a,"display"))&&a!=doc.body)return!1;var b;b=a.getBoundingClientRect();var c=getScrollPos(a.ownerDocument);return[b.left+c[1],b.top+c[0]]};return ua.isIE||(a=function(a){if((null==a.parentNode||null==a.offsetParent||"none"==getStyle(a,"display"))&&a!=doc.body)return!1;var b=null,c=[],d=ua.isSAFARI;c=[a.offsetLeft,a.offsetTop],b=a.offsetParent;var e="absolute"==getStyle(a,"position");if(b!=a)for(;b;)c[0]+=b.offsetLeft+parseInt($.getStyle(b,"borderLeftWidth"),10),c[1]+=b.offsetTop+parseInt($.getStyle(b,"borderTopWidth"),10),d&&!e&&"absolute"==getStyle(b,"position")&&(e=!0),b=b.offsetParent;for(d&&e&&(c[0]-=a.ownerDocument.body.offsetLeft,c[1]-=a.ownerDocument.body.offsetTop),b=a.parentNode;b.tagName&&!/^body|html$/i.test(b.tagName);)getStyle(b,"display").search(/^inline|table-row.*$/i)&&(c[0]-=b.scrollLeft,c[1]-=b.scrollTop),b=b.parentNode;return c}),a}(),getScrollPos=function(){var a=doc.documentElement,b=doc.body;return[Math.max(a.scrollTop,b.scrollTop),Math.max(a.scrollLeft,b.scrollLeft),Math.max(a.scrollWidth,b.scrollWidth),Math.max(a.scrollHeight,b.scrollHeight)]},getPosition=function(a){for(var b=0,c=0;null!=a;)b+=a.offsetLeft,c+=a.offsetTop,a=a.offsetParent;return{top:c,left:b}},getStyle=function(a,b){if("getComputedStyle"in window)return getComputedStyle(a,null)[b];b=b.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()});var c=a.currentStyle[b];if(!("auto"!==c&&"100%"!=c||"width"!==b&&"height"!==b)){var d=a.getBoundingClientRect();return"width"===b?d.right-d.left+"px":d.bottom-d.top+"px"}return c},setStyle=function(a,b){if(a)for(var c in b)a.style[c]=b[c]},trim=function(a){return a.replace(/(^[\s\u3000]*)|([\s\u3000]*$)/g,"")},encodeHTML=function(a){var b="";return"string"!=typeof a?a:0===a.length?"":(b=a.replace(/&/g,"&gt;"),b=b.replace(/</g,"&lt;"),b=b.replace(/>/g,"&gt;"),b=b.replace(/ /g,"&nbsp;"),b=b.replace(/\'/g,"'"),b=b.replace(/\"/g,"&quot;"))},decodeHTML=function(a){var b="";return"string"!=typeof a?a:0===a.length?"":(b=a.replace(/&gt;/g,"&"),b=b.replace(/&lt;/g,"<"),b=b.replace(/&gt;/g,">"),b=b.replace(/&nbsp;/g," "),b=b.replace(/'/g,"'"),b=b.replace(/&quot;/g,'"'))},encodeDoubleByte=function(a){var b="",c=create("div");return c.appendChild(doc.createTextNode(a)),b=c.innerHTML,c=null,b=b.replace(/(&lt;br\/&gt;){1,}/gi,"<br/>"),b=b.replace(/\s/g,"&nbsp;")},byteLength=function(a){if(typeof a==C.U)return 0;var b=a.match(/[^\x00-\x80]/g);return a.length+(b?b.length:0)},strLeft=function(a,b){var c="...",d=a.slice(0,b),e=d.replace(/[^\x00-\xff]/g,"**").length,f=a.length,g=d.length;if(b>e)return d;if(e==b)return b==f||g==f?d:a.slice(0,b-2)+c;switch(e-=d.length){case 0:return d;case b:var h;return b==f?(h=a.slice(0,(b>>1)-1),h+c):h=a.slice(0,b>>1);default:var i=b-e,j=a.slice(i,b);return f=j.replace(/[\x00-\xff]/g,"").length,f?a.slice(0,i)+arguments.callee(j,f):a.slice(0,i)}},indexOf=function(a,b){if(b.indexOf)return b.indexOf(a);for(var c=0,d=b.length;d>c;){if(b[c]===a)return c;c++}return-1},inArray=function(a,b){return indexOf(a,b)>-1},isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},isEmptyObj=function(a,b){var c=!0;for(var d in a){if(b){c=!1;break}if(a.hasOwnProperty(d)){c=!1;break}}return c},extend=function(a,b){for(var c in b)a[c]=b[c];return a},jsonToQuery=function(){var a=function(a,b){return a=null==a?"":a,a=trim(a.toString()),b?encodeURIComponent(a):a};return function(b,c){var d=[];if("object"==typeof b)for(var e in b)if(b[e]instanceof Array)for(var f=0,g=b[e].length;g>f;f++)d.push(e+"="+a(b[e][f],c));else"function"!=typeof b[e]&&d.push(e+"="+a(b[e],c));return d.length?d.join("&"):""}}(),queryToJson=function(a,b){for(var c,d,e,f=trim(a).split("&"),g={},h=function(a){return b?decodeURIComponent(a):a},i=0,j=f.length;j>i;i++)f[i]&&(c=f[i].split("="),e=c[0],d=c[1],c.length<2&&(d=e,e="$nullName"),g[e]?(isArray(g[e])!==!0&&(g[e]=[g[e]]),g[e].push(h(d))):g[e]=h(d));return g},addEvent=function(a,b,c,d){var e=byId(a);if(null==e)throw new Error("addEvent \u627E\u4E0D\u5230\u5BF9\u8C61\uFF1A"+a);return typeof d==C.U&&(d=!1),typeof b==C.U&&(b="click"),e.addEventListener?(e.addEventListener(b,c,d),!0):e.attachEvent?(e.attachEvent("on"+b,c),!0):void(e["on"+b]=c)},removeEvent=function(a,b,c){var d=byId(a);if(null==d)throw"removeEvent \u627E\u4E0D\u5230\u5BF9\u8C61\uFF1A"+a;"function"==typeof c&&(typeof b==C.U&&(b="click"),d.addEventListener?d.removeEventListener(b,c,!1):d.attachEvent&&d.detachEvent("on"+b,c),c[b]=null)},fixEvent=function(a){return typeof a==C.U&&(a=window.event),a.target||(a.target=a.srcElement,a.pageX=a.x,a.pageY=a.y),typeof a.layerX==C.U&&(a.layerX=a.offsetX),typeof a.layerY==C.U&&(a.layerY=a.offsetY),a},byClass=function(a,b,c){b=b||document,b="string"==typeof b?byId(b):b,c=c||"*";var d=[];a=" "+a+" ";for(var e=byTag(c),f=e.length,g=0;f>g;++g){var h=e[g];if(1==h.nodeType){var i=" "+h.className+" ";-1!=i.indexOf(a)&&(d[d.length]=h)}}return d},builder=function(a,b){var c,d,e;a=function(){return"string"==typeof a?byId(a):a}(),d=byAttr(a,b),c={},e={};for(var f=0,g=d.length;g>f;f++){var h=d[f].getAttribute(b);h&&(c[h]||(c[h]=[]),c[h].push(d[f]),e[h]||(e[h]=d[f]))}return e.wrap=a,{box:a,list:c,ids:e}},custEvent=function(){var a="__custEventKey__",b=1,c={},d=function(b,d){var e="number"==typeof b?b:b[a];return e&&c[e]&&{obj:"string"==typeof d?c[e][d]:c[e],key:e}};return{define:function(d,e){if(d&&e){var f="number"==typeof d?d:d[a]||(d[a]=b++),g=c[f]||(c[f]={});e=[].concat(e);for(var h=0;h<e.length;h++)g[e[h]]||(g[e[h]]=[]);return f}},undefine:function(b,d){if(b){var e="number"==typeof b?b:b[a];e&&c[e]&&("string"==typeof d?d in c[e]&&delete c[e][d]:delete c[e])}},add:function(a,b,c,e){if(a&&"string"==typeof b&&c){var f=d(a,b);if(!f||!f.obj)throw"custEvent ("+b+") is undefined !";return f.obj.push({fn:c,data:e}),f.key}},remove:function(a,b,c){if(a){var e,f,g=d(a,b);if(g&&(e=g.obj)){if(isArray(e))if(c)for(f=0;f<e.length&&e[f].fn!==c;f++)e.splice(f,1);else e.splice(0);else for(f in e)e[f]=[];return g.key}}},fire:function(a,b,c){if(a&&"string"==typeof b){var e,f=d(a,b);if(f&&(e=f.obj)){isArray(c)||(c=c!==undefined?[c]:[]);for(var g=0;g<e.length;g++){var h=e[g].fn;h&&h.apply&&h.apply($,[{type:b,data:e[g].data}].concat(c))}return f.key}}},destroy:function(){c={},b=1}}}(),delegatedEvent=function(){var a=function(a,b){for(var c=0,d=a.length;d>c;c+=1)if(contains(a[c],b))return!0;return!1},b=function(a){var b=function(){};for(var c in a)return b(c),!1;return!0};return function(c,d,e){d||(d=[]),isArray(d)&&(d=[d]);var f={};e=e||"action-type";var g=function(b){var g=b||window.event,h=g.target||g.srcElement,i=b.type;if(a(d,h))return!1;if(!contains(c,h))return!1;for(var j=null,k=function(){return f[i]&&f[i][j]?f[i][j]({evt:g,el:h,e:b,data:queryToJson(h.getAttribute("action-data")||"")}):!0};h&&h!==c&&h.getAttribute&&(j=h.getAttribute(e),k()!==!1);)h=h.parentNode},h={};return h.add=function(a,b,d){f[b]||(f[b]={},addEvent(c,b,g));var e=f[b];e[a]=d},h.remove=function(a,d){f[d]&&(delete f[d][a],b(f[d])&&(delete f[d],removeEvent(c,d,g)))},h.pushExcept=function(a){d.push(a)},h.removeExcept=function(a){if(a)for(var b=0,c=d.length;c>b;b+=1)d[b]===a&&d.splice(b,1);else d=[]},h.clearExcept=function(){d=[]},h.destroy=function(){for(var a in f){for(var b in f[a])delete f[a][b];delete f[a],removeEvent(c,g,a)}},h}}(),bind2=function(){return Function.prototype.bind2=function(a){var b=this;return function(){return b.apply(a,arguments)}},function(a,b){var c=a;return function(){return c.apply(b,arguments)}}}(),parseParam=function(a,b){var c;try{if(typeof b!=C.U)for(c in a)null!=b[c]&&(a[c]=b[c])}finally{return c=null,a}},Url=function(){return Url=function(a){a=a||"",this.url=a,this.query={},this.parse()},Url.prototype={parse:function(a){a&&(this.url=a),this.parseAnchor(),this.parseParam()},parseAnchor:function(){var a=this.url.match(/\#(.*)/);a=a?a[1]:null,this._anchor=a,null!=a&&(this.anchor=this.getNameValuePair(a),this.url=this.url.replace(/\#.*/,""))},parseParam:function(){var a=this.url.match(/\?([^\?]*)/);a=a?a[1]:null,null!=a&&(this.url=this.url.replace(/\?([^\?]*)/,""),this.query=this.getNameValuePair(a))},getNameValuePair:function(a){var b={};return a.replace(/([^&=]*)(?:\=([^&]*))?/gim,function(a,c,d){""!==c&&(b[c]=d||"")}),b},getParam:function(a){return this.query[a]||""},clearParam:function(){this.query={}},setParam:function(a,b){if(null==a||""===a||"string"!=typeof a)throw new Error("no param name set");this.query=this.query||{},this.query[a]=b},setParams:function(a){this.query=a},serialize:function(a){var b=[];for(var c in a)b.push(null==a[c]||""===a[c]?c+"=":c+"="+a[c]);return b.join("&")},toString:function(){var a=this.serialize(this.query);return this.url+(a.length>0?"?"+a:"")+(this.anchor?"#"+this.serialize(this.anchor):"")},getHashStr:function(a){return this.anchor?"#"+this.serialize(this.anchor):a?"#":""}},Url}(),placeholder=function(){var a="placeholder"in create("input");return function(b){function c(b){if(!a){var c=b.getAttribute("hasPlaceholder")||0;if("1"!==c){var d=function(){""===b.value&&(addClass(b,"gray"),b.value=f),b.onfocus=function(){(""===b.value||b.value===f)&&(this.value="",removeClass(b,"gray"))},b.onblur=function(){""===b.value&&(this.value=f,addClass(b,"gray"))}},e=function(){var a=create("input");a.type="text",a.className="pwd_placeholder gray "+b.className,a.value=f,a.autocomplete="off",b.style.display="none",b.parentNode.appendChild(a),a.onfocus=function(){a.style.display="none",b.style.display="",b.focus()},b.onblur=function(){""===b.value&&(a.style.display="",b.style.display="none")}},f=b.getAttribute("placeholder");f||b.attributes&&b.attributes.placeholder&&(f=b.attributes.placeholder.value);var g=b.tagName;if("INPUT"==g){var h=b.type;"password"==h&&f?e():"text"==h&&f&&d()}else"TEXTAREA"==g&&d();b.setAttribute("hasPlaceholder","1")}}}for(var d=b.length-1;d>=0;d--){var e=b[d];c(e)}}}(),Timer=function(){this.list={},this.refNum=0,this.clock=null,this.allpause=!1,this.delay=25,this.add=function(a){if("function"!=typeof a)throw"The timer needs add a function as a parameters";var b=""+(new Date).getTime()+Math.random()*Math.pow(10,17);return this.list[b]={fun:a,pause:!1},this.refNum<=0&&this.start(),this.refNum++,b},this.remove=function(a){this.list[a]&&(delete this.list[a],this.refNum--),this.refNum<=0&&this.stop()},this.pause=function(a){this.list[a]&&(this.list[a].pause=!0)},this.play=function(a){this.list[a]&&(this.list[a].pause=!1)},this.stop=function(){clearInterval(this.clock),this.clock=null},this.start=function(){var a=this;this.clock=setInterval(function(){a.loop.apply(a)},this.delay)},this.loop=function(){for(var a in this.list)this.list[a].pause||this.list[a].fun()}},throttle=function(a,b){clearTimeout(a.__tId__),a.__tId__=setTimeout(function(){a.call(b)},100)},reachBottom=function(){var a=doc.documentElement,b=doc.body,c=Math.min,d=Math.max,e=function(){var e=0,f=0,g=0;try{return a&&a.scrollTop?e=a.scrollTop:b&&(e=b.scrollTop),f=b.clientHeight&&a.clientHeight?c(b.clientHeight,a.clientHeight):d(b.clientHeight,a.clientHeight),g=d(b.scrollHeight,a.scrollHeight),e+f>g-150}catch(h){return!1}};return e}(),shine=function(){var a=new Timer,b=function(a){return a.slice(0,a.length-1).concat(a.concat([]).reverse())};return function(c,d){var e,f=parseParam({start:"#fff",color:"#fbb",times:2,step:5,length:4},d),g=f.start.split(""),h=f.color.split(""),i=[];for(e=0;e<f.step;e+=1){for(var j=g[0],k=1;k<f.length;k+=1){var l=parseInt(g[k],16),m=parseInt(h[k],16);j+=Math.floor(parseInt(l+(m-l)*e/f.step,10)).toString(16)}i.push(j)}for(e=0;e<f.times;e+=1)i=b(i);var n=!1,o=a.add(function(){if(i.length){if(n)return void(n=!1);n=!0,c.style.backgroundColor=i.pop()}else a.remove(o)})}}(),Clz=function(a){var b="___ytreporp___",c=function(){this.init.apply(this,arguments)};if(a){var d=function(){};d.prototype=a.prototype,c.prototype=new d}return c.prototype.init=function(){},c.prototype.set=function(a,c){this[b]||(this[b]={});for(var d,e=0,f=this[b],g=a.split("."),h=g.length,i=h-1;h>e;)d=g[e],e==i&&(f[d]=c),f[d]===undefined&&(f[d]={}),f=f[d],e++},c.prototype.get=function(a){this[b]||(this[b]={});for(var c,d=0,e=this[b],f=a.split("."),g=f.length,h=g-1;g>d;){if(c=f[d],d==h)return e[c];e[c]===undefined&&(e[c]={}),e=e[c],d++}},c.fn=c.prototype,c.fn.parent=c,c._super=c.__proto__,c.extend=function(a){var b=a.extended;for(var d in a)c[d]=a[d];b&&b(c)},c.include=function(a){var b=a.included;for(var d in a)c.fn[d]=a[d];b&&b(c)},c},animate=function(){function Anim(){this.init.apply(this,arguments[0])}var Tween={Linear:function(a,b,c,d){return c*a/d+b},Quad:{easeIn:function(a,b,c,d){return c*(a/=d)*a+b},easeOut:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},easeInOut:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b}},Cubic:{easeIn:function(a,b,c,d){return c*(a/=d)*a*a+b},easeOut:function(a,b,c,d){return c*((a=a/d-1)*a*a+1)+b},easeInOut:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a+b:c/2*((a-=2)*a*a+2)+b}},Quart:{easeIn:function(a,b,c,d){return c*(a/=d)*a*a*a+b},easeOut:function(a,b,c,d){return-c*((a=a/d-1)*a*a*a-1)+b},easeInOut:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a*a+b:-c/2*((a-=2)*a*a*a-2)+b}},Quint:{easeIn:function(a,b,c,d){return c*(a/=d)*a*a*a*a+b},easeOut:function(a,b,c,d){return c*((a=a/d-1)*a*a*a*a+1)+b},easeInOut:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a*a*a+b:c/2*((a-=2)*a*a*a*a+2)+b}},Sine:{easeIn:function(a,b,c,d){return-c*Math.cos(a/d*(Math.PI/2))+c+b},easeOut:function(a,b,c,d){return c*Math.sin(a/d*(Math.PI/2))+b},easeInOut:function(a,b,c,d){return-c/2*(Math.cos(Math.PI*a/d)-1)+b}},Expo:{easeIn:function(a,b,c,d){return 0===a?b:c*Math.pow(2,10*(a/d-1))+b},easeOut:function(a,b,c,d){return a==d?b+c:c*(-Math.pow(2,-10*a/d)+1)+b},easeInOut:function(a,b,c,d){return 0===a?b:a==d?b+c:(a/=d/2)<1?c/2*Math.pow(2,10*(a-1))+b:c/2*(-Math.pow(2,-10*--a)+2)+b}},Circ:{easeIn:function(a,b,c,d){return-c*(Math.sqrt(1-(a/=d)*a)-1)+b},easeOut:function(a,b,c,d){return c*Math.sqrt(1-(a=a/d-1)*a)+b},easeInOut:function(a,b,c,d){return(a/=d/2)<1?-c/2*(Math.sqrt(1-a*a)-1)+b:c/2*(Math.sqrt(1-(a-=2)*a)+1)+b}},Elastic:{easeIn:function(a,b,c,d,e,f){if(0===a)return b;if(1==(a/=d))return b+c;f||(f=.3*d);var g;return!e||e<Math.abs(c)?(e=c,g=f/4):g=f/(2*Math.PI)*Math.asin(c/e),-(e*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-g)*Math.PI/f))+b},easeOut:function(a,b,c,d,e,f){if(0===a)return b;if(1==(a/=d))return b+c;f||(f=.3*d);var g;return!e||e<Math.abs(c)?(e=c,g=f/4):g=f/(2*Math.PI)*Math.asin(c/e),e*Math.pow(2,-10*a)*Math.sin(2*(a*d-g)*Math.PI/f)+c+b},easeInOut:function(a,b,c,d,e,f){if(0===a)return b;if(2==(a/=d/2))return b+c;f||(f=.3*d*1.5);var g;return!e||e<Math.abs(c)?(e=c,g=f/4):g=f/(2*Math.PI)*Math.asin(c/e),1>a?-.5*e*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-g)*Math.PI/f)+b:e*Math.pow(2,-10*(a-=1))*Math.sin(2*(a*d-g)*Math.PI/f)*.5+c+b}},Back:{easeIn:function(a,b,c,d,e){return e===undefined&&(e=1.70158),c*(a/=d)*a*((e+1)*a-e)+b},easeOut:function(a,b,c,d,e){return e===undefined&&(e=1.70158),c*((a=a/d-1)*a*((e+1)*a+e)+1)+b},easeInOut:function(a,b,c,d,e){return e===undefined&&(e=1.70158),(a/=d/2)<1?c/2*a*a*(((e*=1.525)+1)*a-e)+b:c/2*((a-=2)*a*(((e*=1.525)+1)*a+e)+2)+b}},Bounce:{easeIn:function(a,b,c,d){return c-Tween.Bounce.easeOut(d-a,0,c,d)+b},easeOut:function(a,b,c,d){return(a/=d)<1/2.75?7.5625*c*a*a+b:2/2.75>a?c*(7.5625*(a-=1.5/2.75)*a+.75)+b:2.5/2.75>a?c*(7.5625*(a-=2.25/2.75)*a+.9375)+b:c*(7.5625*(a-=2.625/2.75)*a+.984375)+b},easeInOut:function(a,b,c,d){return d/2>a?.5*Tween.Bounce.easeIn(2*a,0,c,d)+b:.5*Tween.Bounce.easeOut(2*a-d,0,c,d)+.5*c+b}}},color={sub:function(a,b,c){return c?a.substring(b,b+c):a.substring(b)},hex:function(a){if(0>a)return"00";if(a>255)return"ff";var b="0"+a.toString(16);return b.substring(b.length-2)},GetColors:function(a){a=a.replace("#","");var b,c,d;return a.length>3?(b=color.sub(a,0,2),c=color.sub(a,2,2),d=color.sub(a,4,2)):(b=color.sub(a,0,1),c=color.sub(a,1,1),d=color.sub(a,2,1),b+=b,c+=c,d+=d),[parseInt(b,16),parseInt(c,16),parseInt(d,16)]}},fn={getElement:function(a){return"string"==typeof a?doc.getElementById(a):a},objType:function(a){switch(Object.prototype.toString.call(a)){case"[object Object]":return"Object";case"[object Number]":return"Number";case"[object Array]":return"Array"}},getStyle:function(a,b){var c;if(doc.defaultView){var d=doc.defaultView.getComputedStyle(a,null);"borderWidth"==b?b="borderLeftWidth":b,c=b in d?d[b]:d.getPropertyValue(b),"auto"==c?c="0px":c}return a.style[b]||a.currentStyle&&("auto"==a.currentStyle[b]?"0px":a.currentStyle[b])||c},getOriCss:function(a,b){var c=[];for(var d in b)if(b.hasOwnProperty(d))if("transparent"==fn.getStyle(a,d)||/^#|rgb\(/.test(fn.getStyle(a,d))){if("transparent"==fn.getStyle(a,d)&&c.push([255,255,255]),/^#/.test(fn.getStyle(a,d))&&c.push(color.GetColors(fn.getStyle(a,d))),/^rgb\(/.test(fn.getStyle(a,d))){var e=/^rgb\(([0-9]{0,3}),\s([0-9]{0,3}),\s([0-9]{0,3})\)/g,f=fn.getStyle(a,d).replace(e,"$1 $2 $3").split(" ");c.push([parseInt(f[0]),parseInt(f[1]),parseInt(f[2])])}}else c.push("opacity"==d?100*fn.getStyle(a,d):parseInt(fn.getStyle(a,d)));return c},getEndCss:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push("opacity"==c?100*a[c]:/^#/.test(a[c])?color.GetColors(a[c]):parseInt(a[c]));return b}};return Anim.prototype={init:function(){this.elem=fn.getElement(arguments[0]),this.cssObj=arguments[1],this.cssOri=fn.getOriCss(this.elem,arguments[1]),this.cssEnd=fn.getEndCss(arguments[1]),this.durtime=arguments[2],this.animType="Tween.Linear",this.funObj=null,this.start=!1,this.complete=!1,this.onPause=!1,this.onRestart=!1;var a;if(arguments.length<3)throw new Error("\u81F3\u5C11\u8981\u4F20\u51653\u4E2A\u53C2\u6570");if(4==arguments.length){if("Object"==fn.objType(arguments[3])){this.funObj=arguments[3];for(a in this.funObj)"start"==a.toString()&&(this.start=!0),"complete"==a.toString()&&(this.complete=!0)}"string"==typeof arguments[3]&&(this.animType=arguments[3])}else if(5==arguments.length&&(this.animType=arguments[3],"Object"==fn.objType(arguments[4]))){this.funObj=arguments[4];for(a in this.funObj)"start"==a.toString()&&(this.start=!0),"complete"==a.toString()&&(this.complete=!0)}this.startAnim()},startAnim:function(){this.start&&this.funObj.start.call(this,this.elem);var that=this,t=0,props=[];for(var pro in this.cssObj)this.cssObj.hasOwnProperty(pro)&&props.push(pro);clearInterval(this.timer),this.timer=setInterval(function(){var d,c1,c2,c3,b1,b2,b3,r,g,b,i;if(that.onPause)return void clearInterval(that.timer);if(t<that.durtime/10)for(t++,i=0;i<props.length;i++){var c;"Array"!=fn.objType(that.cssOri[i])&&(b=that.cssOri[i]),"Array"!=fn.objType(that.cssEnd[i])&&(c=that.cssEnd[i]-that.cssOri[i]),d=that.durtime/10,"Array"==fn.objType(that.cssOri[i])&&"Array"==fn.objType(that.cssEnd[i])?(b1=that.cssOri[i][0],b2=that.cssOri[i][1],b3=that.cssOri[i][2],c1=that.cssEnd[i][0]-that.cssOri[i][0],c2=that.cssEnd[i][1]-that.cssOri[i][1],c3=that.cssEnd[i][2]-that.cssOri[i][2],r=color.hex(Math.ceil(eval(that.animType)(t,b1,c1,d))),g=color.hex(Math.ceil(eval(that.animType)(t,b2,c2,d))),b=color.hex(Math.ceil(eval(that.animType)(t,b3,c3,d))),that.elem.style[props[i]]="#"+r+g+b):that.elem.style[props[i]]="opacity"==props[i].toString()?Math.ceil(eval(that.animType)(t,b,c,d))/100:Math.ceil(eval(that.animType)(t,b,c,d))+"px"}else{for(i=0;i<props.length;i++)"Array"==fn.objType(that.cssOri[i])&&"Array"==fn.objType(that.cssEnd[i])?(c1=that.cssEnd[i][0],c2=that.cssEnd[i][1],c3=that.cssEnd[i][2],r=color.hex(Math.ceil(eval(that.animType)(t,b1,c1,d))),g=color.hex(Math.ceil(eval(that.animType)(t,b2,c2,d))),b=color.hex(Math.ceil(eval(that.animType)(t,b3,c3,d))),that.elem.style[props[i]]="#"+r+g+b):that.elem.style[props[i]]="opacity"==props[i].toString()?that.cssEnd[i]/100:that.cssEnd[i]+"px";clearInterval(that.timer),that.complete&&that.funObj.complete.call(that,that.elem)}},10)},pause:function(){this.onPause=!0}},function(){return new Anim(arguments)}}(),getGuid=function(){return Math.abs((new Date).getTime())+"_"+Math.round(1e8*Math.random())},jsonp=function(url,cb){var head=byTag("head")[0],ojs=byId(url);ojs&&head.removeChild(ojs),url+=-1==url.indexOf("&")?"?":"&",url=url+"_t"+getGuid();var fun=exports.fun="jsonp_"+getGuid();"function"==typeof cb&&eval(fun+"=function(res){cb(res)}"),url=url+"&callback="+fun;var js=create("script");js.src=url,js.id=url,js.type="text/javascript",js.language="javascript",head.appendChild(js)},jsLoad=function(a,b){var c=byTag("head")[0],d=create("script"),e=!1;d.onload=d.onreadystatechange=function(){e||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(e=!0,d.onload=d.onreadystatechange=null,"function"==typeof b&&b())},d.src=a;try{c.appendChild(d)}catch(f){}},ijax=function(){return{arrTaskLists:[],createLoadingIframe:function(){if(null!=this.loadFrames)return!1;var a="loadingIframe_thread"+Math.ceil(1e4*Math.random()),b="loadingIframe_thread"+Math.ceil(1e4*(Math.random()+1));this.loadFrames=[a,b];var c="";ua.isIE6&&(c='javascript:void((function(){document.open();document.domain="sina.com.cn";document.close()})())');var d='<iframe id="'+a+'" name="'+a+'" class="invisible" scrolling="no" src="" allowTransparency="true" style="display:none;" frameborder="0" ></iframe><iframe id="'+b+'" name="'+b+'" class="invisible" scrolling="no" src="'+c+'" allowTransparency="true" style="display:none;" frameborder="0" ></iframe>',e=create("div");e.id="ijax_iframes",e.innerHTML=d,doc.body.appendChild(e);var f=setInterval(bind2(function(){null!=byId(this.loadFrames[0])&&null!=byId(this.loadFrames[1])&&(clearInterval(f),f=null,this.loadingIframe={thread1:{container:byId(this.loadFrames[0]),isBusy:!1},thread2:{container:byId(this.loadFrames[1]),isBusy:!1}},this.loadByList())},this),10)},isIjaxReady:function(){if(typeof this.loadingIframe==C.U)return!1;for(var a in this.loadingIframe)if(!this.loadingIframe[a].isBusy)return this.loadingIframe[a].isBusy=!0,this.loadingIframe[a];return!1},request:function(a,b){var c={};c.url=a,c.option=b||{},this.arrTaskLists.push(c),null==this.loadFrames?this.createLoadingIframe():this.loadByList()},loadByList:function(){if(0===this.arrTaskLists.length)return!1;var a=this.isIjaxReady();if(!a)return!1;var b=this.arrTaskLists[0];this.loadData(b.url,b.option,a),this.arrTaskLists.shift()},loadData:function(a,b,c){var d=new Url(a);if(b.GET)for(var e in b.GET)d.setParam(e,encodeDoubleByte(b.GET[e]));d=d.toString();var f=c.container;if(f.listener=bind2(function(){if(b.onComplete||b.onException)try{var a,e=f.contentWindow.document,g=byTag("textarea")[0];a=typeof g!=C.U?g.value:e.body.innerHTML,b.onComplete?b.onComplete(a):b.onException()}catch(h){b.onException&&b.onException(h.message,d.toString())}c.isBusy=!1,removeEvent(f,"load",f.listener),this.loadByList()},this),addEvent(f,"load",f.listener),b.POST){var g=create("form");g.id="IjaxForm",g.action=d,g.method="post",g.target=f.id;for(var h in b.POST){var i=create("input");i.type="hidden",i.name=h,i.value=b.POST[h],g.appendChild(i)}doc.body.appendChild(g);try{g.submit()}catch(j){}}else try{window.frames(f.id).location.href=d}catch(j){f.src=d}}}}(),html5Ijax=function(){var a=function(){},b=/^http\s?\:\/\/[a-z\d\-\.]+/i,c="ijax-html5-iframe-",d=function(a){a=a||{},this.init(a)};return d.prototype={ready:!1,init:function(d){if(!this.ready){var e,f,g,h,i,j=this,k=d.proxyUrl;if(j.onsuccess=d.onsuccess||a,j.onfailure=d.onfailure||a,k){i=function(a){if(!j.ready||a.origin!==j.target)return void j.destroy();var b=a.data;b&&"failure"!==b?(j.onsuccess&&j.onsuccess(a.data),j.destroy()):(j.destroy(),j.onfailure&&j.onfailure())},addEvent(window,"message",i),e=c+Date.parse(new Date),f='<iframe id="'+e+'" name="'+e+'" src="'+k+'" frameborder="0" style="width:0;height:0;display:none;"></iframe>';var l=create("div");l.id=c+"iframes",l.innerHTML=f,g=l.childNodes[0],h=function(){j.ready=!0;var a=g.src,c=a.match(b);j.target=c&&c[0]||"*"},addEvent(g,"load",h),doc.body.insertBefore(g,doc.body.firstChild),j._iframe=g,j._iframeLoaded=h,j._receiver=i}}},send:function(a){a=a||{};var b=this,c=a.url,d=a.data,e=a.onsuccess,f=a.onfailure;if(c&&"string"==typeof c){if(e&&(b.onsuccess=e),f&&(b.onfailure=f),!b.ready)return void setTimeout(function(){b.send(a)},50);d?d+="&_url="+window.encodeURIComponent(c):d="_url="+window.encodeURIComponent(c),b._iframe.contentWindow.postMessage(d,b.target)}},destroy:function(){var a=this._iframe;removeEvent(a,"load",this._iframeLoaded),a.parentNode.removeChild(a),removeEvent(window,"message",this._receiver),this._iframe=null,this._iframeLoaded=null,this._receiver=null}},d}(),$={C:C,doc:doc,byId:byId,byTag:byTag,byAttr:byAttr,hasClass:hasClass,addClass:addClass,removeClass:removeClass,toggleClass:toggleClass,preventDefault:preventDefault,stopPropagation:stopPropagation,contains:contains,create:create,insertAfter:insertAfter,ua:ua,domReady:domReady,timeoutHandle:timeoutHandle,getXY:getXY,getScrollPos:getScrollPos,getPosition:getPosition,getStyle:getStyle,setStyle:setStyle,trim:trim,encodeHTML:encodeHTML,decodeHTML:decodeHTML,encodeDoubleByte:encodeDoubleByte,byteLength:byteLength,strLeft:strLeft,indexOf:indexOf,inArray:inArray,isArray:isArray,isEmptyObj:isEmptyObj,extend:extend,jsonToQuery:jsonToQuery,queryToJson:queryToJson,addEvent:addEvent,removeEvent:removeEvent,fixEvent:fixEvent,byClass:byClass,builder:builder,custEvent:custEvent,delegatedEvent:delegatedEvent,bind2:bind2,parseParam:parseParam,Url:Url,placeholder:placeholder,Timer:Timer,throttle:throttle,reachBottom:reachBottom,shine:shine,Clz:Clz,animate:animate,getGuid:getGuid,jsonp:jsonp,jsLoad:jsLoad,ijax:ijax,html5Ijax:html5Ijax};$.register=function(a,b){for(var c,d=0,e=$,f=a.split("."),g=f.length,h=g-1;g>d;){if(c=f[d],d==h){if(e[c]!==undefined)throw f+":: has registered";e[c]=b($)}e[c]===undefined&&(e[c]={}),e=e[c],d++}};var EXPORTS_NAME="sinacMNT",UGLIFY_NAME="___"+EXPORTS_NAME+"___";if(exports[UGLIFY_NAME]=$,exports[EXPORTS_NAME])throw'\u4E2A\u6027\u5316\u63A8\u8350\u5168\u5C40\u53D8\u91CF\u540D"'+EXPORTS_NAME+'"\u5DF2\u7ECF\u88AB\u5360\u7528\uFF0C\u53EF\u4F7F\u7528'+UGLIFY_NAME;exports[EXPORTS_NAME]=$}(window),function(a){var b=a.___sinacMNT___;b.register("msg",function(){var a={I001:"\u8BC4\u8BBA\u6210\u529F",I002:"\u5E76\u5DF2\u8F6C\u53D1\u5FAE\u535A",I003:"\u8BF7\u8F93\u5165\u8BC4\u8BBA",I004:"\u8BF7\u8F93\u5165\u5BC6\u7801",I005:"\u8BF7\u5148\u767B\u5F55\u518D\u63D0\u4EA4\u8BC4\u8BBA",I006:"\u5DF2\u5230\u6700\u540E\u4E00\u9875\uFF0C\u66F4\u591A\u7CBE\u5F69\u8BC4\u8BBA&gt;&gt;",I007:"\u53D1\u5E03",I008:"\u652F\u6301",I009:"\u56DE\u590D",I010:"\u5FAE\u535A\u8D26\u53F7/\u535A\u5BA2/\u90AE\u7BB1",I011:"\u4E0B\u6B21\u81EA\u52A8\u767B\u5F55",I012:"\u6CE8\u518C",I013:"\u5FD8\u8BB0\u5BC6\u7801\uFF1F",I014:"\u70B9\u51FB\u52A0\u8F7D\u66F4\u591A",I015:"\u6700\u70ED\u8BC4\u8BBA",I016:"\u6700\u65B0\u8BC4\u8BBA",I017:"\u5237\u65B0",I018:"\u5206\u4EAB\u5230\u5FAE\u535A",I019:"\u5206\u4EAB",I020:"\u5206\u4EAB\u5230\u65B0\u6D6A\u5FAE\u535A",I021:"\u5206\u4EAB\u5230\u817E\u8BAF\u5FAE\u535A",I022:"\u6708",I023:"\u65E5",I024:"\u4ECA\u5929",I025:"\u79D2\u524D",I026:"\u5206\u949F\u524D",I027:"\u66F4\u591A\u7CBE\u5F69\u8BC4\u8BBA&gt;&gt;",I028:"\u8FD8\u6709<% this.num %>\u6761\u8BC4\u8BBA",I029:"\u767B\u5F55",I030:"\u9000\u51FA",I031:"<em><% this.comment %></em>\u6761\u8BC4\u8BBA",I032:"<em><% this.person %></em>\u4EBA\u53C2\u4E0E",I033:"<em><% this.post %></em>\u6761\u76F8\u5173\u5E16\u5B50",I034:"\u67E5\u770B\u5BF9\u8BDD",I035:"\u6536\u8D77\u5BF9\u8BDD",I036:"\u56DE\u590D<% this.userLnk %>\uFF1A",I037:"\uFF1A",I038:"\u6211\u6709\u8BDD\u8BF4",I039:'<span class="reply-form-tip"><em>\u70B9\u8D5E\u6210\u529F\uFF01</em>\u518D\u5BF9TA\u8BF4\u70B9\u4EC0\u4E48\u5427~</span>',I040:"&lt;&lt;\u67E5\u770B\u66F4\u65E9\u5BF9\u8BDD",I041:"\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u5019...",I042:"\u8BC4\u8BBA\u8D85\u65F6\uFF0C\u8BF7\u7A0D\u5019\u518D\u8BD5"},b=function(){var b={set:function(b,c){"all"!==b?a[b]=c:a=c},get:function(b){return"undefined"==typeof b?a:a[b]}};return b}();return b})}(window),function(a){var b=a.___sinacMNT___;b.custEvent.define(b,["ce_login","ce_weiboLogin","ce_loginError","ce_logout"]);var c=!0;if(!a.SSOController)throw new Error("\u672A\u52A0\u8F7Dhttp://i.sso.sina.com.cn/js/ssologin.js");var d=a.sinaSSOController;b.register("login",function(){var e=new b.Clz,f=function(a,c){var d=["login","weibo_login","logout","weibo_login_security"],e="sinacMNT_";c=c||0,b.domReady(function(){var f=b.byTag("body")[0];b.addClass(f,e+a);for(var g=0,h=d.length;h>g;g++){var i=d[g];i==a||c||b.removeClass(f,e+i)}})},g=function(a){b.jsonp("http://comment5.news.sina.com.cn/user/security",function(b){if(b&&b.result&&b.result.data){var c=b.result.data.is_security||!1;c&&"function"==typeof a&&a()}})},h=null;return e.include({init:function(a){var b=this;b._setOpt(a),b._setLogin()},_setOpt:function(a){this.set("opt",b.extend({loginSuccess:function(){},logoutSuccess:function(){},error:function(){}},a,!0))},_setLogin:function(){var e=this,g=e.get("opt");"undefined"!=typeof a.sinaSSOController&&(d.loginExtraQuery.vsnf=1,d.service="vblog",d.pageCharset="GB2312",d.setDomain=!0,d.customLoginCallBack=function(d){var f=!b.inArray(d.errno,["5024","5025","4049","2070"]);return d.result?(c&&a.SINA_OUTLOGIN_LAYER&&a.SINA_OUTLOGIN_LAYER.listener.fire("login_success"),e._logined(),void g.loginSuccess(d)):(b.custEvent.fire(b,"ce_loginError",{validated:f,info:d}),g.error(),!1)},d.customLogoutCallBack=function(d){c&&a.SINA_OUTLOGIN_LAYER&&a.SINA_OUTLOGIN_LAYER.listener.fire("logout_success"),b.custEvent.fire(b,"ce_logout"),g.logoutSuccess(d),f("logout")},e.autoIn())},autoIn:function(){var a=this;d.autoLogin(function(b){return b?void a._logined():void f("logout")})},_logined:function(){this.getWeiboInfo(function(a){f("weibo_login"),h=a.result,b.custEvent.fire(b,"ce_weiboLogin"),g(function(){f("weibo_login_security",1)})},function(){f("login")})},isLogin:function(){return a.sinaSSOController.getSinaCookie()},getWeiboInfo:function(c,d){var e=a.sinaSSOController.getSinaCookie(),f="http://api.sina.com.cn/weibo/2/users/show.json?uid="+e.uid+"&source=2835469272",g=b.getGuid();b.timeoutHandle(g,function(a){a.timeout(g,function(){d()}),b.jsonp(f,function(b){c(b),a.success(g)
})},3e3)},lOut:function(){d.logout()},lIn:function(a,b,c){d.login(a,b,c)},synStatus:function(){var a=this,b=a.isLogin();b?a.autoIn():a.lOut()},getName:function(){var a="",b=d.getSinaCookie();return h?a='<a href="http://weibo.com" target="_blank">'+(h.data.screen_name||h.data.name)+"</a>":b&&(a=b.nick||b.name),a},getInfo:function(){return{sina:d.getSinaCookie(),weibo:h}},getCommentConfig:function(){var a=this.getInfo(),b="";if(a.weibo){var c=a.weibo.data;b="&wb_verified="+c.verified+"&wb_screen_name="+c.screen_name+"&wb_user_id="+c.idstr+"&wb_time=&wb_profile_img="+c.profile_image_url}return b}}),new e})}(window),function(exports,undefined){var $=exports.___sinacMNT___,doc=$.doc;$.register("app",function(){var app={};return app.track=function(a,b){try{exports._S_uaTrack(a,b)}catch(c){}},app.textareaUtils=function(){var a={},b=doc.selection;return a.selectionStart=function(a){if(!b)return a.selectionStart;var c=b.createRange(),d=0,e=doc.body.createTextRange();for(e.moveToElementText(a),d;e.compareEndPoints("StartToStart",c)<0;d++)e.moveStart("character",1);return d},a.selectionBefore=function(b){return b.value.slice(0,a.selectionStart(b))},a.selectText=function(a,c,d){if(a.focus(),!b)return void a.setSelectionRange(c,d);var e=a.createTextRange();e.collapse(1),e.moveStart("character",c),e.moveEnd("character",d-c),e.select()},a.insertText=function(c,d,e,f){if(c.focus(),f=f||0,!b){var g=c.value,h=e-f,i=h+d.length;return c.value=g.slice(0,h)+d+g.slice(e,g.length),void a.selectText(c,i,i)}var j=b.createRange();j.moveStart("character",-f),j.text=d},a.getCursorPos=function(a){var c=0;if($.ua.isIE){a.focus();var d=null;d=b.createRange();var e=d.duplicate();e.moveToElementText(a),e.setEndPoint("EndToEnd",d),a.selectionStart=e.text.length-d.text.length,a.selectionEnd=a.selectionStart+d.text.length,c=a.selectionStart}else(a.selectionStart||"0"===a.selectionStart)&&(c=a.selectionStart);return c},a.getSelectedText=function(a){var c="",d=function(a){return a.selectionStart!==undefined&&a.selectionEnd!==undefined?a.value.substring(a.selectionStart,a.selectionEnd):""};return c=window.getSelection?d(a):b.createRange().text},a.setCursor=function(a,b,c){if(b=null===b?a.value.length:b,c=null===c?0:c,a.focus(),a.createTextRange){var d=a.createTextRange();d.move("character",b),d.moveEnd("character",c),d.select()}else a.setSelectionRange(b,b+c)},a.unCoverInsertText=function(a,b,c){c=null===c?{}:c,c.rcs=null===c.rcs?a.value.length:1*c.rcs,c.rccl=null===c.rccl?0:1*c.rccl;var d=a.value,e=d.slice(0,c.rcs),f=d.slice(c.rcs+c.rccl,""===d?0:d.length);a.value=e+b+f,this.setCursor(a,c.rcs+(null===b?0:b.length))},a}(),app.splitNum=function(a){a+="";for(var b=/(-?\d+)(\d{3})/;b.test(a);)a=a.replace(b,"$1,$2");return a},app.template=function(a,b){function c(a){return!("undefined"==typeof a||!a.nodeName||!a.nodeType)}function d(a,b){for(var c,d=/<%([^%>]+)?%>/g,e=/(^( )?(if|for|else|switch|case|break|{|}))(.*)?/g,f="var r=[];\n",g=0,h=function(a,b){return f+=b?a.match(e)?a+"\n":"r.push("+a+");\n":a?'r.push("'+a.replace(/"/g,'\\"')+'");\n':"",h};c=d.exec(a);)h(a.slice(g,c.index))(c[1],!0),g=c.index+c[0].length;return h(a.substr(g,a.length-g)),f+='return r.join("");',new Function(f.replace(/[\r\t\n]/g,"")).apply(b)}if(c(a)){var e=/^(textarea|input)$/i.test(a.nodeName)?a.value:a.innerHTML;return d(e,b)}return d(a,b)},app.simCheckbox=function(a){var b="sina-comment-chkbox-selected",c=$.hasClass(a,b);c?($.removeClass(a,b),a.setAttribute("checked",0)):($.addClass(a,b),a.setAttribute("checked",1))},app.textareaAutoGrow=function(){var a=function(a,b){for(var c=0,d="";b>c;c++)d+=a;return d},b=function(b){var c=b.value.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&/g,"&amp;").replace(/\n$/,"<br/>&nbsp;").replace(/\n/g,"<br/>").replace(/ {2,}/g,function(b){return a("&nbsp;",b.length-1)+" "});return c},c=function(a,b){var c=this,d={clzPrefix:"autogrow-textarea-",minHeight:"auto",maxHeight:1/0,context:a.parentNode,styles:{},realTime:!0,speed:200};b=$.extend(d,b),"auto"===b.minHeight&&(b.minHeight=$.getStyle(a,"height").replace("px","")),a&&(c.stop=!1,c.config=b,c.textarea=a,c._bindEvent(),c.setCloneStyle(),c.grow())};return c.prototype={constructor:c,_bindEvent:function(){var a=this,b=a.textarea;$.addEvent(b,"keyup",function(){a.throttleGrow()}),$.addEvent(b,"focus",function(){a.throttleGrow()}),$.addEvent(window,"resize",function(){a.throttleGrow()})},setCloneStyle:function(){var a=this,b=a.config,c=a.textarea;a.clone||(a.clone=document.createElement("div"),a.clone.className=b.clzPrefix+"clone",b.context.appendChild(a.clone));var d=a.clone,e={position:"absolute",wordWrap:"break-word",top:0,left:"-9999px"},f={};f=$.isEmptyObj(b.styles)?$.extend(e,{width:$.getStyle(c,"width"),fontSize:$.getStyle(c,"fontSize"),fontFamily:$.getStyle(c,"fontFamily"),lineHeight:$.getStyle(c,"lineHeight")}):$.extend(e,b.styles),$.setStyle(d,f)},throttleGrow:function(){var a=this;a.stop||$.throttle(a.grow,a,a.config.speed)},grow:function(){var a=this,c=a.config;c.realTime&&a.setCloneStyle(),a.clone.innerHTML=b(a.textarea);var d=$.getStyle(a.clone,"height").replace("px",""),e="hidden";d=Math.max(d,c.minHeight),d>c.maxHeight&&(d=c.maxHeight,e="auto"),d=Math.min(d,c.maxHeight),$.setStyle(a.textarea,{height:d+"px",overflow:e})},revive:function(){var a=this;a.stop=!1},destroy:function(){var a=this;a.stop=!0}},c}(),app.getWinSize=function(a){var b,c,d;return d=a?a.document:document,"CSS1Compat"===d.compatMode?(b=d.documentElement.clientWidth,c=d.documentElement.clientHeight):window.innerHeight?(d=a?a.self:window,b=d.innerWidth,c=d.innerHeight):d.documentElement&&d.documentElement.clientHeight?(b=d.documentElement.clientWidth,c=d.documentElement.clientHeight):d.body&&(b=d.body.clientWidth,c=d.body.clientHeight),navigator.userAgent.match(/iPad;.*CPU.*OS 7_\d/i)&&!window.navigator.standalone&&b>c&&(c=672),{width:b,height:c}},app.post=function(url,param,cb,timeoutCb,time){var cbName="iJax"+Date.parse(new Date);try{doc.domain="sina.com.cn"}catch(e){}param.callback=cbName;var TIMEOUT_NAME="TD_"+(new Date).getTime();$.timeoutHandle(TIMEOUT_NAME,function(handle){if(handle.timeout(TIMEOUT_NAME,function(){"function"==typeof timeoutCb&&timeoutCb()}),window[cbName]=function(m){"string"==typeof m&&(m=eval("("+m+")")),"function"==typeof cb&&cb(m),handle.success(TIMEOUT_NAME)},!$.ua.isFF||param.iframe&&1===param.iframe)$.ijax.request(url,{POST:param});else{param.callback=undefined,param=$.jsonToQuery(param);var Sender=new $.html5Ijax({proxyUrl:"http://comment5.news.sina.com.cn/comment/postmsg.html"});Sender.send({url:url,data:param,onsuccess:window[cbName],onfailure:function(){}})}},time||5e3)},app.cmntEncodeHtml=function(a){function b(a){return a=a.replace(/(&lt\;br\/&gt\;){3,}/g,"&lt;br/&gt;"),a=a.replace(/^(&lt\;br\/&gt\;)+/g,""),a=a.replace(/(&lt\;br\/&gt\;)+$/g,"")}return a=$.encodeHTML($.decodeHTML(a)),a=b(a),a=a.replace(/&lt\;br\/&gt\;/g,"<br>")},app})}(window),function(exports,undefined){var $=exports.___sinacMNT___,doc=$.doc,uaTrack=$.app.track,UNDEFINED=$.C.U,app=$.app,getMsg=$.msg.get;$.register("cmnt",function(){var cmnt={};return cmnt.config=function(){var a={};return{set:function(b,c){a[b]=c},get:function(b){return typeof b==UNDEFINED?a:a[b]}}}(),cmnt.data=function(){var a={},b=$.isArray,c=$.extend;return{set:function(d,e,f){typeof a[d]==UNDEFINED&&(a[d]={}),typeof a[d][e]==UNDEFINED&&(a[d][e]={});var g,h,i=a[d][e];if(b(f))for(var j=0,k=f.length;k>j;j++)g=f[j],g.mid?h=g.mid:g.newsid&&(h=g.newsid),i[h]=g;else i=c(i,f);a[d][e]=i},get:function(b,c,d){return b?c?d?a[b][c][d]:a[b][c]||a[c]||a:a[b]||a:a}}}(),cmnt.face=function(){function a(a){if(h.isShow&&a){var b=a.target||a.srcElement;b===h.iniTarget||$.contains(h.iconLayer,b)||h.hide()}}function b(a,b,c,d){b=b||"360px",c=c||{};var e=[];for(var f in c)e.push('<li><a href="javascript:void(0)" action-type="face-insert"action-data="text=['+f+']" title="'+f+'"><img src="'+d+c[f]+'.gif" alt="'+f+'" /></a></li>');var g=[];g.push('<table class="sina-comment-layer">'),g.push('<tbody><tr> <td class="a-l-top-l"></td> <td class="a-l-top-c"></td> <td class="a-l-top-r"></td> </tr> <tr> <td class="a-l-m-l"></td> <td class="a-l-m-c"><div class="a-l-box">'),g.push('<div class="a-l-box-con" style="'+b+'">'),g.push('<div class="sina-comment-face-list clearfix">'),g.push('<div class="a-l-arrow"></div>'),g.push('<div class="a-l-close-wrap">'),g.push('<a action-type="face-close" class="a-l-close" href="javascript:;" title="\u5173\u95ED"></a>'),g.push("</div>"),g.push('<div class="face-list-items">'),g.push('<ul id="J_Faces_Icos">'),g.push(e.join("")),g.push("</ul>"),g.push("</div>"),g.push("</div>"),g.push("</div>"),g.push('</div></td><td class="a-l-m-r"></td></tr><tr><td class="a-l-btm-l"></td> <td class="a-l-btm-c"></td><td class="a-l-btm-r"></td></tr></tbody></table>');var h=$.create("div");return h.innerHTML=g.join(""),h.style.display="none",(a||doc.body).appendChild(h),h}function c(a,b){if($.ua.isIE){var c=a.createTextRange();if(c.collapse(!0),a.caretPos){var d=a.caretPos;d.text=" "==d.text.charAt(d.text.length-1)?b+" ":b,c.moveStart("character",a.value.indexOf(b)+1),c.moveEnd("character",b.length-2)}else{var e=doc.selection.createRange();doc.selection.empty(),e.text=b}}else if(a.setSelectionRange){var f=a.selectionStart,g=a.selectionEnd,h=a.value.substring(0,f),i=a.value.substring(g),j=h+b,k=j.length;a.value=j+i,a.setSelectionRange(k,k)}else a.value+=b}var d="http://i3.sinaimg.cn/dy/deco/2012/1217/face/",e="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/",f={"\u54C8\u54C8":"haha","\u5077\u7B11":"tx","\u6CEA":"lei","\u563B\u563B":"xixi","\u7231\u4F60":"aini","\u6316\u9F3B\u5C4E":"wbs","\u5FC3":"xin"},g={"\u56FD\u65D7":"dc/flag_thumb","\u8D70\u4F60":"ed/zouni_thumb","\u7B11\u54C8\u54C8":"32/lxhwahaha_thumb","\u6C5F\u5357style":"67/gangnamstyle_thumb","\u5410\u8840":"8c/lxhtuxue_thumb","\u597D\u6FC0\u52A8":"ae/lxhjidong_thumb","lt\u5207\u514B\u95F9":"73/ltqiekenao_thumb","moc\u8F6C\u53D1":"cb/moczhuanfa_thumb","ala\u8E66":"b7/alabeng_thumb","gst\u8010\u4F60":"1b/gstnaini_thumb","xb\u538B\u529B":"e0/xbyali_thumb","din\u63A8\u649E":"dd/dintuizhuang_thumb","\u8349\u6CE5\u9A6C":"7a/shenshou_thumb","\u795E\u9A6C":"60/horse2_thumb","\u6D6E\u4E91":"bc/fuyun_thumb","\u7ED9\u529B":"c9/geili_thumb","\u56F4\u89C2":"f2/wg_thumb","\u5A01\u6B66":"70/vw_thumb","\u718A\u732B":"6e/panda_thumb","\u5154\u5B50":"81/rabbit_thumb","\u5965\u7279\u66FC":"bc/otm_thumb","\u56E7":"15/j_thumb","\u4E92\u7C89":"89/hufen_thumb","\u793C\u7269":"c4/liwu_thumb","\u5475\u5475":"ac/smilea_thumb","\u563B\u563B":"0b/tootha_thumb","\u54C8\u54C8":"6a/laugh","\u53EF\u7231":"14/tza_thumb","\u53EF\u601C":"af/kl_thumb","\u6316\u9F3B\u5C4E":"a0/kbsa_thumb","\u5403\u60CA":"f4/cj_thumb","\u5BB3\u7F9E":"6e/shamea_thumb","\u6324\u773C":"c3/zy_thumb","\u95ED\u5634":"29/bz_thumb","\u9119\u89C6":"71/bs2_thumb","\u7231\u4F60":"6d/lovea_thumb","\u6CEA":"9d/sada_thumb","\u5077\u7B11":"19/heia_thumb","\u4EB2\u4EB2":"8f/qq_thumb","\u751F\u75C5":"b6/sb_thumb","\u592A\u5F00\u5FC3":"58/mb_thumb","\u61D2\u5F97\u7406\u4F60":"17/ldln_thumb","\u53F3\u54FC\u54FC":"98/yhh_thumb","\u5DE6\u54FC\u54FC":"6d/zhh_thumb","\u5618":"a6/x_thumb","\u8870":"af/cry","\u59D4\u5C48":"73/wq_thumb","\u5410":"9e/t_thumb","\u6253\u54C8\u6B20":"f3/k_thumb","\u62B1\u62B1":"27/bba_thumb","\u6012":"7c/angrya_thumb","\u7591\u95EE":"5c/yw_thumb","\u998B\u5634":"a5/cza_thumb","\u62DC\u62DC":"70/88_thumb","\u601D\u8003":"e9/sk_thumb","\u6C57":"24/sweata_thumb","\u56F0":"7f/sleepya_thumb","\u7761\u89C9":"6b/sleepa_thumb","\u94B1":"90/money_thumb","\u5931\u671B":"0c/sw_thumb","\u9177":"40/cool_thumb","\u82B1\u5FC3":"8c/hsa_thumb","\u54FC":"49/hatea_thumb","\u9F13\u638C":"36/gza_thumb","\u6655":"d9/dizzya_thumb","\u60B2\u4F24":"1a/bs_thumb","\u6293\u72C2":"62/crazya_thumb","\u9ED1\u7EBF":"91/h_thumb","\u9634\u9669":"6d/yx_thumb","\u6012\u9A82":"89/nm_thumb","\u5FC3":"40/hearta_thumb","\u4F24\u5FC3":"ea/unheart","\u732A\u5934":"58/pig",ok:"d6/ok_thumb","\u8036":"d9/ye_thumb",good:"d8/good_thumb","\u4E0D\u8981":"c7/no_thumb","\u8D5E":"d0/z2_thumb","\u6765":"40/come_thumb","\u5F31":"d8/sad_thumb","\u8721\u70DB":"91/lazu_thumb","\u86CB\u7CD5":"6a/cake","\u949F":"d3/clock_thumb","\u8BDD\u7B52":"1b/m_thumb"},h={iniTarget:null,srcInput:null,iconLayer:null,iconText:"",isShow:!1,callback:function(){}};return h.show=function(c,d,f,i,j,k){var l,m=h.iconLayer;return m&&a(),h.wrap=h.wrap||null,m&&h.wrap==f||(m=b(f,k,g,e),h.wrap=f),f&&f!=doc.body?l=[0,0]:(l=$.getXY(c),l[1]+=c.offsetHeight),$.ua.isIE&&(l[0]+=-10),isNaN(i)||(l[0]+=i),isNaN(j)||(l[1]+=+j),m.style.cssText="left:"+l[0]+"px;top:"+l[1]+'px;position:absolute;z-index:1700;display:"";zoom:1;',h.iconLayer=m,h.iniTarget=c,h.srcInput=d,h.iconText=null,h.isShow=!0,$.addClass(c,"trigger-active"),$.addEvent(doc.body,"click",a,!1),h.iconLayer},h.hide=function(){var b=h.iconLayer;return b&&(b.style.display="none"),h.iniTarget&&$.removeClass(h.iniTarget,"trigger-active"),$.removeEvent(doc.body,"click",a),h.isShow=!1,b},h.getFace=function(){return h.iconText},h.insert=function(a,b){var d=h.srcInput;a&&(h.hide(),d&&(d.focus(),setTimeout(function(){var e=d.getAttribute("range");if(null==e)c(d,a);else{var f=e.split("&");$.app.textareaUtils.unCoverInsertText(d,a,{rcs:f[0],rccl:f[1]});var g=$.app.textareaUtils.getCursorPos(d,a);d.setAttribute("range",g+"&0")}b&&b()},10)))},h.set=function(a,b,c){"all"==a?(e=b,g=c):(d=b,f=c)},h.get=function(a){return"all"==a?{faces:g,base:e}:{faces:f,base:d}},h.filter=function(){var a=/\[(.*?)\]/g;return function(b){return b=b||"",b=b.replace(a,function(a,b){var c=g[b];return c&&(c=e+c+".gif"),c?'<img class="sina-comment-txt-face" title="'+b+'" alt="'+b+'" src="'+c+'" />':b})}}(),h}(),cmnt.commentTip=function(){var a={};a.timeout=null,a.animate=null;var b=function(){var a=$.create("div");return a.className="sina-comment-tip",a.style.display="none",a.style.position="absolute",$.byTag("body")[0].appendChild(a),a},c=function(){a.dom||(a.dom=b()),clearTimeout(a.timeout),a.animate&&a.animate.pause(),$.animate(a.dom,{opacity:0},200,"Tween.Quad.easeOut",{start:function(){},complete:function(){$.setStyle(a.dom,{left:"-9999px",opacity:0})}})},d=function(a,b,c){var d=$.getStyle(a,"width"),e=$.getStyle(a,"height");return d=parseFloat(d),d=isNaN(d)?b:d,e=parseFloat(e),e=isNaN(e)?c:e,{width:d,height:e}},e=function(c,e,f,g){a.dom||(a.dom=b()),clearTimeout(a.timeout),a.animate&&a.animate.pause(),a.dom.innerHTML='<div class="inner '+e+'"><i></i><div class="txt">'+f+"</div> </div>";var h=$.getXY(c),i=d(a.dom,100,30),j=d(c,100,40);$.setStyle(a.dom,{top:h[1]+j.height/2-i.height/2+"px",left:h[0]+j.width/2-i.width/2+"px",opacity:0,display:""}),g=g||0,g&&(a.timeout=setTimeout(function(){a.hide()},g)),$.animate(a.dom,{opacity:1},200,"Tween.Quad.easeIn",{start:function(){},complete:function(){}})};return a.show=e,a.hide=c,a}(),cmnt.vote=function(a){var b="http://comment5.news.sina.com.cn/cmnt/vote",c=$.extend({channel:"",newsid:"",parent:"",format:"js",vote:1,callback:function(){},domain:"sina.com.cn"},a,!0);$.ijax.request(b,{POST:c})},cmnt.voteTip=function(){var a={};a.timeout=null,a.animate=null;var b=function(){var a=$.create("div");return a.className="sina-comment-vote-tip",a.style.display="none",a.style.position="absolute",$.byTag("body")[0].appendChild(a),a},c=function(){a.dom||(a.dom=b()),clearTimeout(a.timeout),a.animate&&a.animate.pause(),$.animate(a.dom,{opacity:0},200,"Tween.Quad.easeOut",{start:function(){},complete:function(){$.setStyle(a.dom,{left:"-9999px",opacity:0,display:"none"})}})},d=function(a,b,c){var d=$.getStyle(a,"width"),e=$.getStyle(a,"height");return d=parseFloat(d),d=isNaN(d)?b:d,e=parseFloat(e),e=isNaN(e)?c:e,{width:d,height:e}},e=function(c,e){a.dom||(a.dom=b()),clearTimeout(a.timeout),a.animate&&a.animate.pause();var f=$.getXY(c),g=d(a.dom,100,30),h=d(c,100,40);$.setStyle(a.dom,{top:f[1]+"px",left:f[0]+h.width/2-g.width/2+"px",opacity:0,display:"block"}),e=e||0,e&&(a.timeout=setTimeout(function(){a.hide()},e)),$.animate(a.dom,{top:f[1]-35+"px",opacity:1},200,"Tween.Quad.easeIn",{start:function(){},complete:function(){}})};return a.show=e,a.hide=c,a}(),cmnt.shareTip=function(){var encode=encodeURIComponent,getShareName=function(a){var b=function(a){if(typeof a.config==UNDEFINED)return"";var b=a.config.match(/wb_screen_name=([^&]*)/i);return b?b[1]:""},c=b(a),d="",e=a.nick,f=a.usertype;return c?d="@"+c:"wap"==f?(d="\u65B0\u6D6A\u624B\u673A\u7528\u6237","\u624B\u673A\u7528\u6237"!=e&&(d+=e)):(d="\u65B0\u6D6A\u7F51\u53CB",e&&(d+=e)),d},getShareContent=function(a,b,c){a=a.replace(/<.*?>/gi,"");var d={title:a,name:b,content:c},e=$.cmnt.tpls.get("share");return a=$.app.template(e,d),encode(a)},getUrlData=function(data,newWin){var site=data.site,mid=data.mid,sinaAppkey=data.sinaAppkey||"",tencentAppkey=data.tencentAppkey||"",curCmntlist=cmnt.data.get(data.allNewsid,"cmntlist",mid),content=curCmntlist.content,newsid=curCmntlist.newsid,channel=curCmntlist.channel,img="",setWinUrl=function(){var a=location.href,b=getShareName(curCmntlist),c=function(){var a=cmnt.data.get(data.allNewsid,"newsdict",newsid);return typeof a==UNDEFINED&&curCmntlist.news_info?curCmntlist.news_info.title||"":a.title||""}(),d=getShareContent(c,b,content),e={sina:{base:"http://v.t.sina.com.cn/share/share.php?",param:["url=",encode(a),"&title=",d,"&source=",encode("\u65B0\u6D6A\u65B0\u95FB\u8BC4\u8BBA"),"&sourceUrl=",encode("http://news.sina.com.cn/hotnews/"),"&content=","gb2312","&pic=",encode(img),"&appkey=",sinaAppkey||"445563689"].join("")},tencent:{base:"http://share.v.t.qq.com/index.php?",param:["c=","share","&a=","index","&url=",encode(a),"&title=",d,"&content=","gb2312","&pic=",encode(img),"&appkey=",tencentAppkey||"dcba10cb2d574a48a16f24c9b6af610c","&assname=","${RALATEUID}"].join("")}};newWin&&(newWin.location.href=[e[site].base,e[site].param].join(""))},getImgSrc=function(o){var cbName="iJax"+Date.parse(new Date),url="http://comment5.news.sina.com.cn/image";try{doc.domain="sina.com.cn"}catch(e){}window[cbName]=function(m){"string"==typeof m&&(m=eval("("+m+")"));var cmntImg=m.result.image||"";img=img?img+"||"+cmntImg:cmntImg,/Firefox/.test(navigator.userAgent)?setTimeout(function(){setWinUrl()},30):setWinUrl()};var param="";if($.ua.isFF){param="channel="+channel+"&newsid="+newsid+"&mid="+mid;var Sender=new $.io.html5Ijax({proxyUrl:"http://comment5.news.sina.com.cn/comment/postmsg.html"});Sender.send({url:url,data:param,onsuccess:window[cbName],onfailure:function(){}})}else param={channel:channel,newsid:newsid,mid:mid,format:"js",callback:cbName},$.ijax.request(url,{POST:param})},maxCmntLen=80;data.hasReply||$.byteLength(content)>2*maxCmntLen?(content=$.strLeft(content,2*maxCmntLen),getImgSrc()):setWinUrl()},Tip={};Tip.timeout=null,Tip.animate=null,Tip.trigger=null;var getTip=function(a){var b=$.jsonToQuery(a);if(!Tip.dom){Tip.dom=$.create("div"),Tip.dom.className="sina-comment-share",Tip.dom.style.display="none",Tip.dom.style.position="absolute",$.byTag("body")[0].appendChild(Tip.dom),$.addEvent(Tip.dom,"mouseover",function(){clearTimeout(Tip.timeout)}),$.addEvent(Tip.dom,"mouseout",function(){Tip.hide(2e3)});var c=$.delegatedEvent(Tip.dom);c.add("share","click",function(a){var b=a.data,c=window.open("","mb",["toolbar=0,status=0,resizable=1,width=440,height=430,left=",(screen.width-440)/2,",top=",(screen.height-430)/2].join(""));getUrlData(b,c)})}Tip.dom.innerHTML='<a title="'+getMsg("I020")+'" class="sina-comment-share-sina" href="javascript:;" action-type="share" action-data="'+b+'&site=sina">\u65B0\u6D6A</a><a title="'+getMsg("I021")+'" class="sina-comment-share-qq" href="javascript:;" action-type="share" action-data="'+b+'&site=tencent">\u817E\u8BAF</a>'},hide=function(a){clearTimeout(Tip.timeout),Tip.animate&&Tip.animate.pause(),a=a||0,a&&(Tip.timeout=setTimeout(function(){$.animate(Tip.dom,{opacity:0},200,"Tween.Quad.easeOut",{start:function(){},complete:function(){$.setStyle(Tip.dom,{left:"-9999px",opacity:0,display:"none"}),$.removeClass(Tip.trigger,"share-active"),Tip.trigger=null}})},a))},getWH=function(a,b,c){var d=$.getStyle(a,"width"),e=$.getStyle(a,"height");return d=parseFloat(d),d=isNaN(d)?b:d,e=parseFloat(e),e=isNaN(e)?c:e,{width:d,height:e}},show=function(a,b,c){if(Tip.trigger!=a){getTip(b),clearTimeout(Tip.timeout),Tip.animate&&Tip.animate.pause();var d=$.getXY(a),e=getWH(Tip.dom,100,30),f=getWH(a,100,40);$.removeClass(Tip.trigger,"share-active"),Tip.trigger=a,$.setStyle(Tip.dom,{top:d[1]+"px",left:d[0]+f.width/2-e.width/2+"px",opacity:0,display:"block"}),Tip.hide(c),$.animate(Tip.dom,{top:d[1]-27+"px",opacity:1},200,"Tween.Quad.easeIn",{start:function(){$.addClass(Tip.trigger,"share-active")},complete:function(){}})}};return Tip.show=show,Tip.hide=hide,Tip}(),cmnt.comment=function(a,b,c){var d=cmnt.config.get("comment"),e="http://comment5.news.sina.com.cn/cmnt/submit",f=$.extend({channel:"",newsid:"",parent:"",content:"",format:"json",ie:"gbk",oe:"gbk",ispost:0,share_url:location.href.split("#")[0],video_url:"",img_url:"",iframe:1},a,!0);f=$.extend(f,d),$.app.post(e,f,function(a){b(a)},function(){c()})},cmnt.formateTime=function(a,b){var c=getMsg("I022"),d=getMsg("I023"),e=getMsg("I024"),f=getMsg("I025"),g=getMsg("I026"),h=a.getFullYear(),i=b.getFullYear(),j=a.getMonth()+1,k=b.getMonth()+1,l=a.getDate(),m=b.getDate(),n=a.getHours(),o=b.getHours();10>o&&(o="0"+o);var p=b.getMinutes();10>p&&(p="0"+p);var q=a-b;return q=q>0?q:0,q/=1e3,h!=i?i+"-"+k+"-"+m+" "+o+":"+p:j!=k||l!=m?k+c+m+d+o+":"+p:n!=o&&q>3600?e+o+":"+p:51>q?(q=1>q?1:q,Math.floor((q-1)/10)+1+"0"+f):Math.floor(q/60+1)+g},cmnt.updateTime=function(){var a=cmnt.formateTime,b=0,c=function(c){var d=$.byAttr(c,"comment-type","time"),e=new Date;e.setTime(e.getTime()-b);for(var f,g=0;g<d.length;g++){var h=d[g],i=h.getAttribute("date");if(/^\s*\d+\s*$/.test(i)){var j=new Date;j.setTime(parseInt(i,10)),h.innerHTML=a(e,j),f===undefined&&(f=e.getTime()-j.getTime()<6e4)}}return f};return function(a){var b,d=1e3,e=function(f){clearTimeout(b),b=setTimeout(function(){e(c(a)?d:6e4)},f)},f=function(){e(d)};e(d);var g={destroy:function(){clearTimeout(b),g=a=b=e=f=null}};return g}}(),cmnt.getTimeStr=function(){var a=cmnt.formateTime;return function(b,c){c=c||"time";var d="\u521A\u521A",e="";if(b){var f=new Date;b=b.replace(/-/g,"/"),e=Date.parse(b),f.setTime(parseInt(e,10));var g=new Date;g.setTime(g.getTime()),d=a(g,f)}else e=Date.parse(new Date);return'<span class="'+c+'" comment-type="time" date="'+e+'">'+d+"</span>"}}(),cmnt.tpls=function(){var a=" action-data=",b=" action-type=",c=" class=",d=" comment-type=",e=function(a){return"<% this."+a+" %>"},f=null,g=function(){return{formList:'<div class="sina-comment-form"'+d+'"form"> </div> <div class="sina-comment-list"'+d+'"list"> </div>',list:["<div"+c+'"hot-wrap"'+d+'"hotWrap">',"<div"+c+'"title"><span'+c+'"name">'+getMsg("I015")+"</span> <a"+b+'"reflash"'+a+'"type=hot"'+c+'"reflash" href="javascript:;"'+d+'"hotReflash">'+getMsg("I017")+"</a> </div>","<div"+c+'"hot-loading loading"><a href="javascript:;"></a></div>',"<div"+c+'"list"'+d+'"hotList"></div>',"</div>","<div"+c+'"latest-wrap"'+d+'"latestWrap">',"<div"+c+'"title"><span'+c+'"name">'+getMsg("I016")+"</span> <a"+b+'"reflash"'+a+'"type=latest"'+c+'"reflash" href="javascript:;"'+d+'"latestReflash">'+getMsg("I017")+"</a> </div>","<div"+c+'"latest-loading loading"><a href="javascript:;"></a></div>',"<div"+c+'"list"'+d+'"latestList"></div>',"<div"+c+'"more"'+b+'"getMore"'+a+'"type=latest" '+d+'"latestMore"><a href="javascript:;">'+getMsg("I014")+"</a></div>","</div>","<div"+c+'"all-loading loading"><a href="javascript:;"></a></div>'].join(""),cont:["<!-- \u5934\u50CF start -->","<div"+c+'"head">'+e("userFace")+"</div>","<!-- \u5934\u50CF end -->","<!-- \u5185\u5BB9 start -->","<div"+c+'"cont"'+d+'"itemCont">',"<div"+c+'"info">',e("newsLnk"),"<span"+c+'"name '+e("userIco")+'">',e("userLnk"),"</span>","<span"+c+'"area">'+e("area")+"</span>","</div>","<div"+c+'"txt">',"<!-- \u697C\u5C42 start -->",e("reply"),"<!-- \u697C\u5C42 end -->",e("cont"),"</div>","<div"+c+'"action">',e("time"),"<span"+c+'"btns">',"<a"+c+'"vote" title="'+getMsg("I008")+'"'+b+'"vote"'+a+'"channel='+e("channel")+"&newsid="+e("newsid")+"&mid="+e("mid")+'" href="javascript:;">',"<span>",getMsg("I008"),"<em>("+e("agree")+")</em>","</span>","</a>","<a"+c+'"reply"'+b+'"reply"'+a+'"encoding='+e("encoding")+"&maxFloor="+e("maxFloor")+"&channel="+e("channel")+"&allNewsid="+e("allNewsid")+"&newsid="+e("newsid")+"&mid="+e("mid")+"&showReply="+e("showReply")+"&userLnk="+e("oUserLnk")+"&cont="+e("oCont")+'" href="javascript:;" hidefocus>'+getMsg("I009")+"</a>","<a"+c+'"share"'+b+'"shareHover"'+a+'"hasReply='+e("hasReply")+"&channel="+e("channel")+"&allNewsid="+e("allNewsid")+"&newsid="+e("newsid")+"&mid="+e("mid")+'" href="javascript:;">',"<em>"+getMsg("I019")+"</em>","</a>","</span>","</div>","</div>","<!-- \u5185\u5BB9 end -->"].join(""),floor:["<!-- \u5185\u5BB9 start -->","<div"+c+'"cont"'+d+'"itemCont">',"<div"+c+'"info">',"<span"+c+'"num">'+e("floor")+"</span>","<span"+c+'"name '+e("icoClz")+'">'+e("userLnk")+"</span>","<span"+c+'"area">'+e("area")+"</span>","</div>","<div"+c+'"txt">'+e("cont")+"</div>","<div"+c+'"action">'+e("time")+"<span"+c+'"btns">',"<a"+c+'"vote" title="'+getMsg("I008")+'"'+b+'"vote"'+a+'"channel='+e("channel")+"&newsid="+e("newsid")+"&mid="+e("mid")+'" href="javascript:;">',"<span>",getMsg("I008"),"<em>("+e("agree")+")</em>","</span>","</a>","<a"+c+'"reply"'+b+'"reply"'+a+'"encoding='+e("encoding")+"&maxFloor="+e("maxFloor")+"&channel="+e("channel")+"&allNewsid="+e("allNewsid")+"&newsid="+e("newsid")+"&mid="+e("mid")+'" href="javascript:;" hidefocus>\u56DE\u590D</a>',"<a"+c+'"share"'+b+'"shareHover"'+a+'"hasReply='+e("hasReply")+"&channel="+e("channel")+"&allNewsid="+e("allNewsid")+"&newsid="+e("newsid")+"&mid="+e("mid")+'" href="javascript:;">',"<em>"+getMsg("I019")+"</em>","</a>","</span>","</div>","</div>"].join(""),comment:["<div"+c+'"hd">',"<span"+d+'"count" href="#url"'+c+'"count"></span>',"<span"+c+'"tip">\u6211\u6709\u8BDD\u8BF4</span>',"</div>","<div"+c+'"bd">',"<div"+c+'"inner">',"<textarea"+d+'"cont"'+c+'"box" tabindex="1" autocomplete="off" placeholder="'+e("postTip")+'" value="'+e("content")+'">'+e("content")+"</textarea>","</div>","</div>","<div"+c+'"ft clearfix">',"<div"+c+'"login">',"<span"+c+'"login-user"><input'+d+'"user" name="user" autocomplete="off" placeholder="'+getMsg("I010")+'"></span>',"<span"+c+'"login-psw"><input'+d+'"psw" type="password" name="psw" placeholder="'+getMsg("I004")+'"></span>',"<span"+c+'"login-auto sina-comment-chkbox"'+d+'"remeber"'+b+'"checkbox-toggle"> <i></i>',"<span>"+getMsg("I011")+"</span>","</span>","<span"+c+'"login-other"><a href="https://login.sina.com.cn/signup/signup.php" onclick="try{if(window._S_uaTrack){_S_uaTrack(\'entcomment\', \'logon\');}}catch(e){}">'+getMsg("I012")+"</a> |",'<a href="https://login.sina.com.cn/getpass.html">'+getMsg("I013")+"</a>","</span>","</div>","<div"+c+'"face">','<a href="javascript:;"'+c+'"trigger"'+b+'"face-toggle">\u8868\u60C5</a>',"<!-- \u5E38\u7528\u8868\u60C5 start -->","<span"+c+'"common">',"<% for(var i in this.commonFaces) {",'var url = this.commonFacesBase+this.commonFaces[i]+".gif"; %>','<a href="javascript:;"'+b+'"face-insert"'+a+'"type=out&text=[<% i %>]" title="<% i %>"><img src="<% url %>" alt="" /></a>',"<% } %>","</span>","<!-- \u5E38\u7528\u8868\u60C5 end --> </div>","<div"+c+'"control">',"<!-- \u767B\u5F55\u4FE1\u606F start -->","<div"+c+'"user">',"<a"+c+'"ico" href="http://weibo.com" target="_blank">','<img src="http://img.t.sinajs.cn/t4/style/images/common/transparent.gif" title="\u5FAE\u535A" alt="weibo"></a>',"<span"+c+'"name"'+d+'"name">',e("name"),"</span>","&nbsp;|&nbsp;","<a"+d+'"logout"'+c+'"logout" href="javascript:;" onclick="return false;" title="\u9000\u51FA\u767B\u5F55">\u9000\u51FA</a>',"</div>","<!-- \u767B\u5F55\u4FE1\u606F end -->","<div"+d+'"weibo"'+c+'"weibo sina-comment-chkbox"'+b+'"checkbox-toggle"> <i></i>',"<span>"+getMsg("I018")+"</span>","</div>","<!-- \u6309\u94AE start -->","<div"+c+'"btns">',"<a"+d+'"submit" href="javascript:;"'+b+'"tip-toggle"'+c+'"comment btn btn-red btn-disabled">'+getMsg("I007")+"</a>","</div>","<!-- \u6309\u94AE end --> </div>","</div>"].join(""),reply:["<div"+c+'"reply-form-top"'+d+'"replyArrow"> <em>\u25C6</em><span>\u25C6</span></div>',"<div"+c+'"sina-comment-form reply-form"'+d+'"form">',"<div"+c+'"hd">',"<span"+c+'"tip">\u6211\u6709\u8BDD\u8BF4</span>',"</div>","<div"+c+'"bd">',"<div"+c+'"inner">',"<textarea"+d+'"cont"'+c+'"box" tabindex="1" autocomplete="off" placeholder="'+e("postTip")+'">'+e("content")+"</textarea>","</div>","</div>","<div"+c+'"ft clearfix">',"<div"+c+'"login">',"<span"+c+'"login-user"><input'+d+'"user" name="user" autocomplete="off" placeholder="'+getMsg("I010")+'"></span>',"<span"+c+'"login-psw"><input'+d+'"psw" type="password" name="psw" placeholder="'+getMsg("I004")+'"></span>',"<span"+c+'"login-auto sina-comment-chkbox"'+d+'"remeber"'+b+'"checkbox-toggle"> <i></i>',"<span>"+getMsg("I011")+"</span>","</span>","<span"+c+'"login-other"><a href="https://login.sina.com.cn/signup/signup.php" onclick="try{if(window._S_uaTrack){_S_uaTrack(\'entcomment\', \'logon\');}}catch(e){}">'+getMsg("I012")+"</a> |",'<a href="https://login.sina.com.cn/getpass.html">'+getMsg("I013")+"</a>","</span>","</div>","<div"+c+'"face">','<a href="javascript:;"'+c+'"trigger"'+b+'"face-toggle">\u8868\u60C5</a></div>',"<div"+c+'"control">',"<div"+c+'"user">',"<a"+c+'"ico" href="http://weibo.com" target="_blank">','<img src="http://img.t.sinajs.cn/t4/style/images/common/transparent.gif" title="\u5FAE\u535A" alt="weibo"></a>',"<span"+c+'"name"'+d+'"name">',e("name"),"</span>","&nbsp;|&nbsp;","<a"+d+'"logout"'+c+'"logout" href="javascript:;" onclick="return false;" title="\u9000\u51FA\u767B\u5F55">\u9000\u51FA</a>',"</div>","<div"+d+'"weibo"'+c+'"weibo sina-comment-chkbox"'+b+'"checkbox-toggle"> <i></i>',"<span>"+getMsg("I018")+"</span>","</div>","<div"+c+'"btns">',"<a"+d+'"submit" href="javascript:;"'+b+'"tip-toggle"'+c+'"comment btn btn-red btn-disabled">'+getMsg("I007")+"</a>","</div>","</div></div>"].join(""),share:"#\u7CBE\u5F69\u8BC4\u8BBA#\u3010"+e("title")+"\u3011"+e("name")+"\uFF1A"+e("content")}};return{set:function(a,b){f=f||g(),f[a]=b},get:function(a){return f=f||g(),typeof a==UNDEFINED?f:f[a]}}}(),cmnt.getWBName=function(a){if(typeof a.config==UNDEFINED)return"";var b=a.config.match(/wb_screen_name=([^&]*)/i);return b?b[1]:""},cmnt.getWBV=function(a){if(typeof a.config==UNDEFINED)return"";var b="",c=$.queryToJson(a.config),d=c.wb_verified,e=c.wb_verified_type;return typeof d!=UNDEFINED&&"1"==d&&(b="0"==e?"y":"b"),b},cmnt.getUserLnk=function(a){var b="",c=cmnt.getWBV(a),d="\u65B0\u6D6A\u4E2A\u4EBA\u8BA4\u8BC1";c&&("b"==c&&(d="\u65B0\u6D6A\u673A\u6784\u8BA4\u8BC1"),b='<img src="http://i3.sinaimg.cn/dy/deco/2013/0608/v'+c+'.png" title="'+d+'" style="vertical-align: middle;" />');var e=cmnt.getWBName(a),f="http://comment5.news.sina.com.cn/comment/skin/default.html?info_type=1&style=1&user_uid=";return e?'<a href="'+f+a.uid+'" target="_self">'+e+b+"</a>":a.uid&&"0"!=a.uid?'<a href="'+f+a.uid+'" target="_self">'+a.nick+"</a>":a.nick},cmnt.getUserFace=function(a){var b="http://weibo.com/u/",c=a.config||"",d=$.queryToJson(c,!0).wb_profile_img||"http://i3.sinaimg.cn/dy/deco/2012/1018/sina_comment_defaultface.png",e=cmnt.getWBName(a);return e?'<a href="'+b+a.uid+'" title="'+e+'" target="_blank"><img src="'+d+'"/></a>':'<img src="'+d+'"/>'},cmnt.getUserIco=function(a){var b={wap:"name-mobile",wb:"name-weibo"},c=b[a.usertype];if(c=c||"",!c){var d=cmnt.getWBName(a);c=d?b.wb:""}return c},cmnt.insertList=function(a,b){var c,d=0;a.insertBefore(b,a.firstChild),setTimeout(function(){c=$.getPosition(a),d=c.top-80;try{doc.documentElement.scrollTop=d,doc.body.scrollTop=d}catch(b){}},1e3)},cmnt.replyListRender=function(){var a=cmnt.getTimeStr,b=$.app.splitNum,c=$.app.template,d=cmnt.data;return function(e,f,g,h,i,j){j&&d.set(e,"cmntlist",g);var k="";if(g&&g.length>0)for(var l=0,m=g.length;m>l;l++){var n=g[l],o=n.area?"["+n.area+"]":"&nbsp;",p="";0!==l&&(p=1);var q=$.cmnt.face.filter(app.cmntEncodeHtml(n.content)),r={allNewsid:e,channel:n.channel,newsid:n.newsid,mid:n.mid,floor:l+1,userIco:cmnt.getUserIco(n),userLnk:cmnt.getUserLnk(n),area:o,cont:q,time:a(n.time,"time"),agree:b(n.agree),hasReply:p,maxFloor:h,encoding:i},s=$.cmnt.tpls.get("floor"),t=c(s,r);k=h>l?'<div comment-type="floor" class="floor clearfix">'+k+t+"</div>":k+'<div comment-type="floor" class="floor floor-out clearfix">'+t+"</div>"}return""!==k&&(k='<div class="floor-wrap">'+k+"</div>"),k}}(),cmnt.getNewsLink=function(a,b){var c="",d="";if(b.newsdict){var e=b.newsdict;c=e[a],typeof c!=UNDEFINED&&(d='<a class="lnk" target="_blank" href="'+c.url+'" title="'+c.title+'">'+c.title+"</a>")}return d},cmnt.itemRender=function(){var a=$.encodeHTML,b=cmnt.getTimeStr,c=$.app.splitNum,d=$.app.template,e=function(a){var b=/<(?:.|\s)*?>/g;return a.replace(b,"")};return function(f,g,h,i,j,k,l,m){if(typeof g.mid==UNDEFINED)return"";var n=g.newsid,o=g.mid,p=g.area?"["+g.area+"]":"&nbsp;";i=i||h.replydict[o];var q=cmnt.replyListRender(f,o,i,k,m,1),r="";q&&(r=1);var s=$.cmnt.face.filter(app.cmntEncodeHtml(g.content)),t={channel:g.channel,allNewsid:f,newsid:n,mid:o,userFace:cmnt.getUserFace(g),newsLnk:cmnt.getNewsLink(n,h),userIco:cmnt.getUserIco(g),userLnk:cmnt.getUserLnk(g),oUserLnk:e(cmnt.getUserLnk(g)),area:p,reply:q,cont:s,oCont:a(g.content),time:b(g.time,"time"),agree:c(g.agree),hasReply:r,maxFloor:k,showReply:l,encoding:m},u=$.cmnt.tpls.get("cont");
return j&&(u='<div class="item clearfix" comment-type="item">'+u+"</div>"),d(u,t)}}(),cmnt.DataLoader=function(){var a=new $.Clz;return a.include({init:function(a){var b=this;b._setOpt(a),b.data=null,b.loading=!1,b.getData()},_setOpt:function(a){this.set("opt",$.extend({url:"",param:{},beforeLoad:function(){},loaded:function(){},error:function(){}},a,!0))},getData:function(){var a=this,b=a.get("opt"),c=b.url,d=b.param,e="loader_"+$.getGuid();c+=c.indexOf("?")>-1?"&":"?",c=c+$.jsonToQuery(d)+"&jsvar="+e,a.loading=!0,b.beforeLoad(),$.jsLoad(c,function(){var d=exports[e];if(typeof d!=UNDEFINED){if(0!==d.result.status.code||typeof d.result.error!=UNDEFINED){var f=d.result.status.msg;throw b.error(f),new Error("\u6570\u636E\u52A0\u8F7D\u51FA\u9519\uFF1A"+f+";URL:"+c)}a.data=d.result,b.loaded(a),a.loading=!1}})}}),a}(),cmnt.List=function(){var a=function(){var a=!1;return function(b,c,d){var e=d.pageNum,f=d.firstPageNum||e,g=d.hotPageNum,h=[];if("object"!=typeof c||0===c.length)return"";var i,j,k=d.type,l=d.data,m=d.maxFloor,n=d.showReply,o=d.encoding,p=0,q=0,r=0,s="",t=0,u=0;if("latest"==k){for(t=0,i=c.length;i>t;t++){u++;var v=f>p?f:e;j=c[t],1===u&&(h.push('<div class="sina-comment-page sina-comment-page-hide" style="display:none;">'),q++,r++),h.push(cmnt.itemRender(b,j,l,null,1,m,n,o)),u===v&&(h.push("</div>"),q++,u=0),p++}q%2&&h.push("</div>")}else if("hot"==k)for(t=0,i=c.length;i>t;t++)j=c[t],g>p&&(h.push(cmnt.itemRender(b,j,l,null,1,m,n,o)),p++);else for(t=0,i=c.length;i>t;t++)j=c[t],h.push(cmnt.itemRender(b,j,l,null,1,m,n,o)),(p+1)/g==1&&(h.push("</div>"),q++);if(!a&&r>1){try{exports._S_uaTrack("entcomment","onemorepageview")}catch(w){}a=!0}return s=h.join("")}}(),b=$.app.template,c=new $.Clz(cmnt.DataLoader),d=null;return c.include({init:function(a,b,c){var d=this,e={clickMoreTimes:1/0,showReply:1,maxFloor:10,pageNum:10,hotPageNum:10,hideList:0};c=$.extend(e,c),d.set("clickMoreTimes",0),d.set("countShowed",0);var f={url:b||"http://comment5.news.sina.com.cn/page/info",config:c,param:{version:1,format:"js",channel:c.channel,newsid:c.newsid,group:c.group||c.style,compress:1,ie:c.encoding,oe:c.encoding,page:1,show_reply:c.showReply,page_size:c.pageSize},listType:"all",beforeLoad:function(){d.beforeLoad(),"function"==typeof c.beforeLoad&&c.beforeLoad()},loaded:function(a){a.render(a),a.loaded(a),"function"==typeof c.loaded&&c.loaded(a)}};d.firstRender=!0,d.isReflash=!0,d._setOpt(f),d.loading=!1,d._setDom(a),d.getData()},_setDom:function(a){var c=this;a=$.byId(a);var d=$.cmnt.tpls.get("list");a.innerHTML=b(d,{});var e=$.builder(a,"comment-type");c.set("dom",e.ids)},beforeLoad:function(){var a=this,b=a.get("dom"),c=a.get("opt.listType");$.addClass(b.wrap,"sina-comment-list-"+c+"-loading")},loaded:function(){var a=this,b=a.get("dom"),c=a.get("opt"),d=a.data,e=c.listType;return a.firstRender&&(cmnt.updateTime(b.wrap),a.firstRender=!1),$.removeClass(b.wrap,"sina-comment-list-"+e+"-loading"),d.news&&"N_CLOSE"==d.news.status?void(b.wrap.style.display="none"):void(0===d.cmntlist.length&&a.setMoreLink(getMsg("I006")))},setMoreLink:function(a){var b=this,c=b.get("dom"),d=b.get("opt");c.latestMore&&(c.latestMore.__innerHTML__||(c.latestMore.__innerHTML__=c.latestMore.innerHTML),c.latestMore.setAttribute("action-type",""),c.latestMore.innerHTML='<a href="http://comment5.news.sina.com.cn/comment/skin/default.html?channel='+d.param.channel+"&newsid="+d.param.newsid+"&group="+d.param.group+'">'+a+"</a>")},reSetMoreLink:function(){var a=this,b=a.get("dom");b.latestMore&&b.latestMore.__innerHTML__&&(b.latestMore.innerHTML=b.latestMore.__innerHTML__),b.latestMore.setAttribute("action-type","getMore")},render:function(){var b=this,c=b.data,d=b.get("dom"),e=b.get("opt"),f=e.config;if(!f.hideList){var g=f.maxFloor,h=f.pageNum,i=f.hotPageNum,j=e.param,k=j.newsid,l=e.listType;b.setNewsData(c),b.totalNum=typeof c.count==UNDEFINED?0:b.data.count.show;var m=c.cmntlist,n=c.hot_list;if(m.length){b.cList=b.cList?b.cList.concat(m):m,b.cList=b.cList.concat(n);var o="",p="",q={data:c,maxFloor:g,pageNum:h,hotPageNum:i,showReply:f.showReply,encoding:f.encoding,firstPageNum:f.firstPageNum};if("all"==l)q.type="hot",p=a(k,n,q),q.type="latest",o=a(k,m,q),d.hotList&&(d.hotList.innerHTML=p),d.latestList.innerHTML=o,b.showFirstHidePage(),b.checkClickTimes(b.get("clickMoreTimes"));else if("latest"==l){if(q.type="latest",o=a(k,m,q),1==j.page)d.latestList.innerHTML=o;else{var r=$.create("div");r.innerHTML=o,d.latestList.appendChild(r)}b.showFirstHidePage(),b.checkClickTimes(b.get("clickMoreTimes"))}else q.type="hot",p=a(k,n,q),d.hotList&&(d.hotList.innerHTML=p);return b.setDataClz(l,p,o),b.loading=!1,b.bindEvent(),b}}},showFirstHidePage:function(){var a=this,b=a.get("dom"),c="sina-comment-page-hide",d="sina-comment-page-show",e=$.byClass(c,b.latestList);if(e&&e.length>0){var f=e[0],g=a.get("countShowed");if(a.set("countShowed",0),f){var h=$.byClass("item",f);a.set("countShowed",g+h.length),f.style.display="",$.removeClass(f,c),$.addClass(f,d)}return!0}return!1},getMoreLatest:function(){var a=this,b=a.get("clickMoreTimes");if(!a.showFirstHidePage()){var c=a.get("opt.param.page");a.setType("latest").setPage(c+1).getData()}a.set("clickMoreTimes",b+1),a.checkClickTimes(b+1)},checkClickTimes:function(a){var c=this,d=c.get("opt"),e=d.config;a>=e.clickMoreTimes&&c.setMoreLink(b(getMsg("I028"),{num:c.totalNum-c.get("countShowed")})+getMsg("I027"))},bindEvent:function(){var a=this,b=a.get("dom");if(a.firstRender){var c=$.delegatedEvent(b.wrap);c.add("vote","click",function(a){var b=a.el,c=a.data,d=b.getAttribute("voted");if("true"!=d){$.cmnt.vote({channel:c.channel,newsid:c.newsid,parent:c.mid}),$.cmnt.voteTip.show(b,1e3),$.addClass(b,"vote-active");var e=b.title,f="\u5DF2"+e,g=b.innerHTML,h=parseInt(g.replace(/[^\d]/g,""),10),i=h+1;b.innerHTML=g.replace($.app.splitNum(h),$.app.splitNum(i)).replace(e,f),b.title=f,b.setAttribute("voted","true")}}),c.add("reply","click",function(b){var c=b.el,e=b.data,f=e.mid;if(d){var g=d.get("opt.parent");if(d.destroy(),d=null,g==f)return}var h=e.showReply,i="",j=function(){};"0"==h&&(i="//@"+e.userLnk+" "+e.cont,j=function(b,c){var d=a.get("dom.latestList"),e=a.get("opt.config");e.hideList||cmnt.insertList(d,c)}),d=new $.cmnt.ReplyForm(c,{allNewsid:e.allNewsid,channel:e.channel,newsid:e.newsid,parent:e.mid,content:i,maxFloor:e.maxFloor,encoding:e.encoding||"gbk",showReply:h,commented:j});var k=d.get("dom.cont");"0"==h&&$.app.textareaUtils.insertText(k,"",0,0)}),c.add("reflash","click",function(b){var c=b.data;a.setType(c.type).getData(),a.reSetMoreLink(),a.set("clickMoreTimes",0),a.set("countShowed",0)}),c.add("getMore","click",function(){a.getMoreLatest()}),c.add("shareHover","mouseover",function(a){var b=a.el,c=a.data;$.cmnt.shareTip.show(b,c)}),c.add("shareHover","mouseout",function(){$.cmnt.shareTip.hide(2e3)})}},setNewsData:function(a){var b=cmnt.data,c=this.get("opt.param.newsid");return a&&(a.news&&b.set(c,"newsdict",[a.news]),$.isEmptyObj(a.newsdict)||b.set(c,"newsdict",a.newsdict),b.set(c,"cmntlist",a.cmntlist),a.hot_list&&b.set(c,"cmntlist",a.hot_list),b.set(c,"replydict",a.replydict)),this},setDataClz:function(a,b,c){var d=this.get("dom.wrap"),e="sina-comment-list-has-";b&&($.addClass(d,e+a),"all"===a&&$.addClass(d,e+"hot")),c&&($.addClass(d,e+a),"all"===a&&$.addClass(d,e+"latest"))},setPage:function(a){return 1>a?this:(this.set("opt.param.page",a),this)},setType:function(a){return"all"==a||"hot"==a||"latest"==a?(this.set("opt.listType",a),this):void 0}}),c}(),cmnt.Form=function(){var a=$.app.template,b=cmnt.commentTip,c=$.addEvent,d=$.custEvent,e=!1,f=function(a){var b=a.getAttribute("placeholder");return b||a.attributes&&a.attributes.placeholder&&(b=a.attributes.placeholder.value),b||""},g=new $.Clz;return g.include({init:function(a,b){var c=this;c.commenting=!1,c.commentType="normal",c._setOpt(b),c._setDom(a),c.bindEvent()},_setOpt:function(a){a.allNewsid=a.allNewsid||a.newsid,this.set("opt",$.extend({allNewsid:"",channel:"",newsid:"",parent:"",encoding:"gbk",share_url:location.href.split("#")[0],video_url:"",img_url:"",postTip:getMsg("I003"),content:"",commented:function(){}},a,!0))},_setDom:function(b){var c=this,d=c.get("opt");b=$.byId(b);var e=$.cmnt.face.get("common"),f={content:d.content,postTip:d.postTip,name:$.login.getName(),commonFaces:e.faces,commonFacesBase:e.base},g=$.cmnt.tpls.get("comment");b.innerHTML=a(g,f);var h=$.builder(b,"comment-type");c.set("dom",h.ids)},bindEvent:function(){var a=this,g=a.get("dom"),h=g.cont,i=function(){a.commenting=!0;var c=$.trim(h.value),e=f(h);if(""===c||c===e)return b.show(h,"error",e,3e3),void h.focus();if($.byteLength(c)>6e3)return b.show(h,"error","\u60A8\u7684\u8BC4\u8BBA\u5B57\u6570\u8D85\u51FA\u4E86\u4E0A\u96503000\u5B57,\u8BF7\u4FEE\u6539\u540E\u518D\u63D0\u4EA4\uFF01",3e3),void h.focus();if($.login.isLogin())a.comment();else{var i=$.trim(g.user.value),j=$.trim(g.psw.value);if(""===i||""===j)return b.show(h,"error",getMsg("I005"),3e3),g.user.focus(),void $.login.lOut();a.loginWithComment=!0,d.add($,"ce_login",function(b){"loginWithComment"===b.data.action&&a.loginWithComment&&(a.comment(),a.commenting=!1,a.loginWithComment=!1),g.psw.value=""},{action:"loginWithComment"}),a.login()}},j=function(a,b){window.ActiveXObject?a.onpropertychange=b:a.addEventListener("input",b,!1)};c(g.logout,"click",function(){$.login.lOut(),g.psw.value=""}),c(g.weibo,"click",function(){try{exports._S_uaTrack("entcomment","toweibo")}catch(a){}}),c(g.submit,"click",function(){i()}),c(g.user,"keydown",function(b){b=b||window.event,13==b.keyCode&&a.login()}),c(g.psw,"keydown",function(b){b=b||window.event,13==b.keyCode&&a.login()}),c(h,"keydown",function(a){a=a||window.event,13==a.keyCode&&a.ctrlKey&&i()}),c(h,"keyup",function(){setTimeout(function(){a.toggleSubmitBtn()},200)}),c(g.wrap,"click",function(){setTimeout(function(){a.toggleSubmitBtn()},200)}),c(h,"focus",function(){setTimeout(function(){a.toggleSubmitBtn()},200)}),j(h,function(){a.toggleSubmitBtn()});var k=[g.user,g.psw,h];if($.placeholder(k),!e){var l=$.cmnt.face,m=$.delegatedEvent($.byTag("body")[0]),n=function(a){var b=a.parentNode;return b&&"form"==b.getAttribute("comment-type")?b.getElementsByTagName("textarea")[0]:arguments.callee(b)};m.add("face-toggle","click",function(a){var b=a.el,c=n(b),d="",e=-20,f=5,g="360",h=null;l.hide(),l.show(b,c,d,e,f,g,h)}),m.add("face-insert","click",function(a){var b=a.el,c=a.data.text,d=a.data.type;d&&"out"==d&&(l.srcInput=n(b)),l.insert(c)}),m.add("face-close","click",function(){l.hide()}),m.add("checkbox-toggle","click",function(a){var b=a.el;$.app.simCheckbox(b)}),e=!0}return d.add($,"ce_login",function(){a.setName()}),d.add($,"ce_logout",function(){a.setName()}),d.add($,"ce_weiboLogin",function(){a.setName()}),a},setName:function(){var a=this.get("dom");a.name.innerHTML=$.login.getName()},toggleSubmitBtn:function(){var a=this,b=a.get("dom"),c=b.cont,d=b.submit,e=$.trim(c.value),g=f(c),h="btn-disabled";""===e||e===g?$.addClass(d,h):$.removeClass(d,h)},comment:function(){var a=this,b=a.get("dom"),c=a.get("opt"),d=c.parent;"0"===c.showReply&&(d="");var e=$.trim(b.cont.value);e=e.replace(/\r\n/g,"<br/>"),e=e.replace(/\n/g,"<br/>"),e=e.replace(/\r/g,"<br />"),e=e.replace(/\t/g,"!@");var f=b.weibo.getAttribute("checked");$.cmnt.comment({channel:c.channel,newsid:c.newsid,parent:d,content:e,ie:c.encoding,oe:c.encoding,ispost:f,share_url:c.share_url,video_url:c.video_url,img_url:c.img_url},function(){b.cont.value="",a.commented(e);var c=getMsg("I001");"1"==f&&(c+=getMsg("I002")),cmnt.commentTip.show(b.cont,"succ",c,2e3),uaTrack("entcomment","comment")},function(){cmnt.commentTip.show(b.cont,"error",getMsg("I042"),3e3)})},commented:function(a){var b=this,c=b.get("opt"),d=c.allNewsid,e=c.showReply,f=$.login.getInfo(),g=0,h={},i={newsid:d,mid:"",content:a,time:"",agree:0,config:$.login.getCommentConfig(),nick:f.sina.nick,uid:f.sina.uid,usertype:"",area:""},j=$.create("div");j.className="item item-hack clearfix",j.setAttribute("comment-type","item"),j.innerHTML=cmnt.itemRender(d,i,h,[],0,g,e,c.encoding),c.commented(a,j)},login:function(){try{exports._S_uaTrack("entcomment","login")}catch(a){}if(!$.login.isLogin()){var c=this,e=c.get("dom"),f=$.trim(e.user.value),g=$.trim(e.psw.value),h=parseInt(e.remeber.getAttribute("checked"));""===f||""===g?b.show(e.cont,"error","\u7528\u6237\u540D/\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",3e3):(d.remove($,"ce_loginError"),d.add($,"ce_loginError",function(a,b){b.validated?c.loginError(a,b.info):c.loginVerify(a,b.info)},e),$.login.lIn(f,g,h?7:0),e.user.blur(),e.psw.blur())}},loginError:function(a,c){var d=a.data;b.show(d.cont,"error",c.reason,3e3)},loginVerify:function(a,c){var d=a.data;b.show(d.cont,"error",c.reason+"\uFF0C\u5C06\u8DF3\u8F6C\u5230\u767B\u5F55\u9875..."),setTimeout(function(){location.href="http://login.sina.com.cn/signup/signin.php?entry=acount&url="+encodeURIComponent(location.href)},3e3)},destroy:function(){var a=this,b=a.get("dom"),c=b.wrap;c&&c.parentNode&&c.parentNode.removeChild(c),a.set("opt.parent",""),a=null}}),g}(),cmnt.ReplyForm=function(){var a=function(a,b){var c=a.parentNode;return c&&c.getAttribute&&c.getAttribute("comment-type")==b?c:"body"==c.tagName.toLowerCase()?c:arguments.callee(c,b)},b=$.app.template,c=cmnt.data,d=new $.Clz(cmnt.Form);return d.include({init:function(a,b){var c=this;c.commenting=!1,c._setOpt(b),c._setDom(a),c.bindEvent()},_setDom:function(c){var d=this,e=d.get("opt"),f=$.byId(c);c=$.create("div"),c.className="reply-form-wrap";var g={name:$.login.getName(),content:e.content,postTip:e.postTip},h=$.cmnt.tpls.get("reply");c.innerHTML=b(h,g);var i=a(f,"itemCont"),j=i.parentNode;"item"==j.getAttribute("comment-type")?(d.commentType="out",j.appendChild(c)):(d.commentType="in",$.insertAfter(c,i));var k=$.builder(c,"comment-type");k.ids.trigger=f,k.ids.itemCont=i,k.ids.itemWrap=j,d.set("dom",k.ids),d.setArrowPos()},setArrowPos:function(){var a=this,b=a.get("dom");if(b.replyArrow&&b.trigger){var c=$.getXY(b.trigger),d=$.getXY(b.wrap),e=parseInt($.getStyle(b.replyArrow,"width").replace("px",""),10),f=parseInt($.getStyle(b.trigger,"width").replace("px",""),10),g=parseInt($.getStyle(b.wrap,"width").replace("px",""),10),h=d[0]+g-c[0]-f/2-e/2+"px";b.replyArrow.style.right=h}},commented:function(a){var b=this,d=b.get("opt"),e=b.get("dom"),f=e.itemWrap,g=b.commentType,h=d.allNewsid,i=d.showReply,j=d.maxFloor,k=$.login.getInfo(),l=c.get(h,"cmntlist",d.parent),m=c.get(h),n=c.get(h,"replydict",d.parent);typeof n==UNDEFINED&&(n=[]),n.push(l);var o={newsid:l.newsid,mid:"",content:a,time:"",agree:0,config:$.login.getCommentConfig(),nick:k.sina.nick,uid:k.sina.uid,usertype:"",area:""},p=$.create("div");i=parseInt(i,10),i?"in"==g?(p.className="floor-hack",p.innerHTML=cmnt.itemRender(h,o,m,[],0,j,i,d.encoding),f.appendChild(p)):(p.className="item item-hack clearfix",p.setAttribute("comment-type","item"),p.innerHTML=cmnt.itemRender(h,o,m,n,0,j,i,d.encoding),f.parentNode.insertBefore(p,f),f.parentNode.removeChild(f)):(j=0,m={},o.newsid=h,p.className="item item-hack clearfix",p.setAttribute("comment-type","item"),p.innerHTML=cmnt.itemRender(h,o,m,[],0,j,i,d.encoding),d.commented(a,p)),b.destroy()}}),d}(),cmnt.FormList=function(){var a=$.app.template,b=new $.Clz;return b.include({init:function(a,b,c,d){var e=this;e._setOpt(d),e._setDom(a),e.render(b,c)},_setOpt:function(a){this.set("opt",$.extend({isBBS:0,hideList:0},a,!0))},_setDom:function(b){var c=this;b=$.byId(b),$.addClass(b,"sina-comment-wrap");var d=$.cmnt.tpls.get("formList");b.innerHTML=a(d,{});var e=$.builder(b,"comment-type");c.set("domList",e.list),c.set("dom",e.ids)},render:function(a,b){var c=this,d=c.get("domList"),e=c.get("dom"),f=c.get("opt"),g=d.form;c.commentForms=[];var h=a.commented;a.commented=function(a,b){c.commented(a,b),"function"==typeof h&&h(a,b)};var i=b.loaded;if(b.loaded=function(a){c.loaded(a),"function"==typeof i&&i(a)},d.form)for(var j=g.length-1;j>=0;j--){var k=g[j];c.commentForms.push(new cmnt.Form(k,a))}c.commentList=null,f.hideList||(c.commentList=new cmnt.List(e.list,b.url,b))},setFormOpt:function(a,b){for(var c=this,d=c.commentForms,e=d.length-1;e>=0;e--){var f=d[e];f.set("opt."+a,b)}},setListOpt:function(a,b){var c=this,d=c.commentList;d.set("opt."+a,b)},setListPage:function(a){var b=this,c=b.commentList;c.setPage(a)},setCount:function(){var a,b=this,c=b.get("opt.isBBS"),d=b.commentList,e=d.get("opt"),f=b.commentList.data,g="\u5DF2\u6709<em>"+$.app.splitNum(f.count.show)+"</em>\u6761\u8BC4\u8BBA\uFF0C\u5171<em>"+$.app.splitNum(f.count.total)+"</em>\u4EBA\u53C2\u4E0E",h="",i="javscript:;",j="http://comment5.news.sina.com.cn/comment/skin/default.html";c&&!e.group&&f.grouplist&&0!==f.grouplist.length&&(a=f.grouplist[0],h='\uFF0C<a href="'+j+"?channel="+a.news.channel+"&newsid="+a.news.newsid+'&group=1">\u76F8\u5173\u5E16\u5B50<em>'+$.app.splitNum(a.count.total)+"</em>\u6761</a>"),g+=h,c||(i=j+"?channel="+f.news.channel+"&newsid="+f.news.newsid,1===e.group&&(i+="&style=1")),i&&(g='<a href="'+i+'">'+g+"</a>");for(var k,l,m,n=b.commentForms,o=n.length-1;o>=0;o--)k=n[o],l=k.get("dom"),m=l.count,m.innerHTML=g},loaded:function(){var a=this;a.setCount()},commented:function(a,b){var c=this,d=c.get("opt");if(c.commentList&&!d.hideList){var e=c.commentList,f=e.get("dom.latestList"),g=e.get("opt.config.hideList");typeof g!==UNDEFINED&&1!==g&&(cmnt.insertList(f,b),e.setDataClz("all",e.data.hot_list&&e.data.hot_list.length>1,1))}}}),b}(),cmnt})}(window);